<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome Assessment - Vivify</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: white;
            min-height: 100vh;
        }

        .assessment-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: #1a1a1a;
            border-radius: 16px;
            border: 1px solid #333;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        .assessment-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .assessment-header h1 {
            color: #f39c12;
            margin-bottom: 1rem;
            font-size: 2.5rem;
            font-weight: 700;
        }

        .assessment-header p {
            color: #ccc;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .progress-container {
            margin-bottom: 2rem;
        }

        .progress-text {
            color: #a0a0a0;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .progress-bar {
            height: 8px;
            background: #333;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #f39c12;
            width: 0%;
            transition: width 0.3s;
        }

        .question-card {
            background: #222;
            border-radius: 12px;
            padding: 2rem;
            border: 1px solid #333;
        }

        .question-card h3 {
            color: #f39c12;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            line-height: 1.4;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .option-label {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem 1rem;
            background: #333;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid #555;
            transition: all 0.2s;
            text-align: center;
            min-height: 60px;
        }

        .option-label:hover {
            border-color: #f39c12;
            background: #3a3a3a;
            transform: translateY(-2px);
        }

        .option-label.selected {
            border-color: #f39c12;
            background: #f39c12;
            color: #000;
            font-weight: 600;
        }

        .option-label input[type="radio"] {
            display: none; /* Hide the radio button completely */
        }

        .option-label span {
            color: #ccc;
            font-size: 1rem;
            transition: color 0.2s;
        }

        .option-label.selected span {
            color: #000;
        }

        .btn-primary {
            background: #f39c12;
            color: #000;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 1rem;
        }

        .btn-primary:hover {
            background: #e67e22;
        }

        .btn-secondary {
            background: transparent;
            color: #f39c12;
            border: 1px solid #f39c12;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
        }

        .btn-secondary:hover {
            background: #f39c12;
            color: #000;
        }

        .assessment-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .results-container {
            text-align: center;
        }

        .results-container h2 {
            color: #27ae60;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .scores-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .score-item {
            background: #333;
            padding: 1rem;
            border-radius: 8px;
        }

        .score-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .score-label {
            color: #ccc;
            font-size: 0.9rem;
        }

        .overall-score-display {
            background: #f39c12;
            color: black;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .assessment-container {
                margin: 1rem;
                padding: 1.5rem;
            }

            .scores-grid {
                grid-template-columns: 1fr;
            }

            .assessment-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="wrapper">
        <header>
            <nav>
                <div class="left-nav">
                    <div class="logo">
                        <a href="index.html"><h1>Vivify</h1></a>
                    </div>
                </div>
            </nav>
        </header>

        <main style="padding: 2rem 1rem;">
            <div class="assessment-container">
                <div class="assessment-header">
                    <h1>Welcome to Vivify!</h1>
                    <p>Let's get to know you better with a quick wellness baseline assessment</p>
                    <p style="color: #888; font-size: 0.9rem;">This helps us personalize your experience and track your progress (5 minutes)</p>
                </div>

                <div class="progress-container">
                    <div class="progress-text">
                        Question <span id="currentQuestion">1</span> of <span id="totalQuestions">16</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <div id="questionsContainer" style="min-height: 300px;">
                    <!-- Questions will be loaded here -->
                </div>

                <div class="assessment-buttons">
                    <button class="btn-secondary" id="prevBtn" onclick="previousQuestion()" style="display: none;">Previous</button>
                    <button class="btn-primary" id="nextBtn" onclick="nextQuestion()">Next</button>
                    <button class="btn-primary" id="completeBtn" onclick="completeAssessment()" style="display: none;">Complete Assessment</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        const baselineQuestions = [
            // Physical Health Questions
            {
                category: 'physical',
                text: "How often do you exercise or engage in physical activity?",
                options: [
                    { text: "Daily or almost daily", value: 90 },
                    { text: "3-4 times per week", value: 75 },
                    { text: "1-2 times per week", value: 55 },
                    { text: "Rarely or never", value: 30 }
                ]
            },
            {
                category: 'physical',
                text: "How would you rate your overall energy levels?",
                options: [
                    { text: "High energy throughout the day", value: 85 },
                    { text: "Good energy, occasional fatigue", value: 70 },
                    { text: "Moderate energy, often tired", value: 50 },
                    { text: "Low energy, frequently exhausted", value: 25 }
                ]
            },
            {
                category: 'physical',
                text: "How well do you sleep?",
                options: [
                    { text: "Sleep well, feel rested", value: 80 },
                    { text: "Generally good sleep", value: 65 },
                    { text: "Some sleep issues", value: 45 },
                    { text: "Poor sleep, often tired", value: 25 }
                ]
            },
            {
                category: 'physical',
                text: "How often do you feel physically unwell (headaches, aches, etc.)?",
                options: [
                    { text: "Rarely", value: 85 },
                    { text: "Sometimes", value: 65 },
                    { text: "Often", value: 40 },
                    { text: "Very frequently", value: 20 }
                ]
            },

            // Mental Health Questions  
            {
                category: 'mental',
                text: "How would you describe your overall mood lately?",
                options: [
                    { text: "Generally positive and happy", value: 85 },
                    { text: "Mostly good with some ups and downs", value: 70 },
                    { text: "Mixed, more downs than ups", value: 45 },
                    { text: "Often sad, anxious, or stressed", value: 25 }
                ]
            },
            {
                category: 'mental',
                text: "How well do you handle stress?",
                options: [
                    { text: "Very well, have good coping strategies", value: 80 },
                    { text: "Pretty well, manageable", value: 65 },
                    { text: "Struggle sometimes", value: 45 },
                    { text: "Often overwhelmed by stress", value: 25 }
                ]
            },
            {
                category: 'mental',
                text: "How connected do you feel to friends and family?",
                options: [
                    { text: "Very connected and supported", value: 85 },
                    { text: "Generally connected", value: 70 },
                    { text: "Sometimes feel disconnected", value: 50 },
                    { text: "Often feel isolated", value: 30 }
                ]
            },
            {
                category: 'mental',
                text: "How confident do you feel about handling challenges?",
                options: [
                    { text: "Very confident", value: 80 },
                    { text: "Mostly confident", value: 65 },
                    { text: "Sometimes confident", value: 50 },
                    { text: "Often doubt myself", value: 30 }
                ]
            },

            // Nutrition Questions
            {
                category: 'nutrition',
                text: "How would you describe your eating habits?",
                options: [
                    { text: "Very healthy, balanced meals", value: 85 },
                    { text: "Generally healthy", value: 70 },
                    { text: "Could be better, some unhealthy choices", value: 50 },
                    { text: "Poor eating habits", value: 30 }
                ]
            },
            {
                category: 'nutrition',
                text: "How often do you eat fruits and vegetables?",
                options: [
                    { text: "Daily, multiple servings", value: 90 },
                    { text: "Most days", value: 75 },
                    { text: "A few times per week", value: 55 },
                    { text: "Rarely", value: 30 }
                ]
            },
            {
                category: 'nutrition',
                text: "How much water do you drink daily?",
                options: [
                    { text: "8+ glasses, well hydrated", value: 85 },
                    { text: "6-7 glasses", value: 70 },
                    { text: "3-5 glasses", value: 50 },
                    { text: "Less than 3 glasses", value: 25 }
                ]
            },
            {
                category: 'nutrition',
                text: "How often do you cook your own meals?",
                options: [
                    { text: "Daily or almost daily", value: 80 },
                    { text: "Several times per week", value: 65 },
                    { text: "Occasionally", value: 45 },
                    { text: "Rarely or never", value: 30 }
                ]
            },

            // Life Skills Questions
            {
                category: 'lifeSkills',
                text: "How well do you manage your finances/budget?",
                options: [
                    { text: "Very well, track everything", value: 85 },
                    { text: "Pretty well, mostly organized", value: 70 },
                    { text: "Could be better", value: 50 },
                    { text: "Poor money management", value: 25 }
                ]
            },
            {
                category: 'lifeSkills',
                text: "How organized are you with schoolwork and responsibilities?",
                options: [
                    { text: "Very organized, on top of everything", value: 85 },
                    { text: "Generally organized", value: 70 },
                    { text: "Sometimes disorganized", value: 50 },
                    { text: "Often struggle with organization", value: 30 }
                ]
            },
            {
                category: 'lifeSkills',
                text: "How confident do you feel about your future goals?",
                options: [
                    { text: "Very confident, clear direction", value: 85 },
                    { text: "Mostly confident", value: 70 },
                    { text: "Somewhat uncertain", value: 50 },
                    { text: "Very uncertain about the future", value: 30 }
                ]
            },
            {
                category: 'lifeSkills',
                text: "How well do you communicate with others?",
                options: [
                    { text: "Excellent communication skills", value: 85 },
                    { text: "Good communication", value: 70 },
                    { text: "Average communication", value: 55 },
                    { text: "Struggle with communication", value: 35 }
                ]
            }
        ];

        let currentQuestionIndex = 0;
        let responses = [];

        document.addEventListener('DOMContentLoaded', function() {
            // Check if user should be here
            if (localStorage.getItem('needsBaselineAssessment') !== 'true') {
                window.location.href = 'dashboard.html';
                return;
            }

            document.getElementById('totalQuestions').textContent = baselineQuestions.length;
            loadQuestion();
        });

        function loadQuestion() {
            const question = baselineQuestions[currentQuestionIndex];
            const container = document.getElementById('questionsContainer');
            
            container.innerHTML = `
                <div class="question-card">
                    <h3>${question.text}</h3>
                    <div class="options-grid">
                        ${question.options.map((option, index) => `
                            <label class="option-label">
                                <input type="radio" name="question${currentQuestionIndex}" value="${option.value}">
                                <span>${option.text}</span>
                            </label>
                        `).join('')}
                    </div>
                </div>
            `;

            // Add hover effects and selection handling
            const labels = container.querySelectorAll('.option-label');
            labels.forEach(label => {
                const input = label.querySelector('input');
                
                label.addEventListener('mouseenter', () => {
                    if (!input.checked) {
                        label.style.borderColor = '#f39c12';
                        label.style.background = '#3a3a3a';
                    }
                });
                
                label.addEventListener('mouseleave', () => {
                    if (!input.checked) {
                        label.style.borderColor = '#555';
                        label.style.background = '#333';
                    }
                });
                
                input.addEventListener('change', () => {
                    labels.forEach(l => {
                        l.style.borderColor = '#555';
                        l.style.background = '#333';
                    });
                    if (input.checked) {
                        label.style.borderColor = '#f39c12';
                        label.style.background = '#3a3a3a';
                    }
                });
            });

            updateProgress();
            updateButtons();
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / baselineQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
        }

        function updateButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const completeBtn = document.getElementById('completeBtn');

            prevBtn.style.display = currentQuestionIndex > 0 ? 'block' : 'none';
            
            if (currentQuestionIndex === baselineQuestions.length - 1) {
                nextBtn.style.display = 'none';
                completeBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                completeBtn.style.display = 'none';
            }
        }

        function nextQuestion() {
            const selectedOption = document.querySelector(`input[name="question${currentQuestionIndex}"]:checked`);
            
            if (!selectedOption) {
                alert('Please select an answer before continuing.');
                return;
            }

            responses[currentQuestionIndex] = {
                question: baselineQuestions[currentQuestionIndex].text,
                category: baselineQuestions[currentQuestionIndex].category,
                value: parseInt(selectedOption.value),
                answer: selectedOption.parentElement.textContent.trim()
            };

            if (currentQuestionIndex < baselineQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
                
                // Restore previous selection
                if (responses[currentQuestionIndex]) {
                    const value = responses[currentQuestionIndex].value;
                    const radio = document.querySelector(`input[name="question${currentQuestionIndex}"][value="${value}"]`);
                    if (radio) {
                        radio.checked = true;
                        radio.parentElement.style.borderColor = '#f39c12';
                        radio.parentElement.style.background = '#3a3a3a';
                    }
                }
            }
        }

        function completeAssessment() {
            const selectedOption = document.querySelector(`input[name="question${currentQuestionIndex}"]:checked`);
            
            if (!selectedOption) {
                alert('Please answer the final question.');
                return;
            }

            responses[currentQuestionIndex] = {
                question: baselineQuestions[currentQuestionIndex].text,
                category: baselineQuestions[currentQuestionIndex].category,
                value: parseInt(selectedOption.value),
                answer: selectedOption.parentElement.textContent.trim()
            };

            calculateBaselineScores();
        }

        function calculateBaselineScores() {
            const scores = {
                physical: [],
                mental: [],
                nutrition: [],
                lifeSkills: []
            };

            // Group responses by category
            responses.forEach(response => {
                if (scores[response.category]) {
                    scores[response.category].push(response.value);
                }
            });

            // Calculate average for each category
            const finalScores = {};
            Object.keys(scores).forEach(category => {
                if (scores[category].length > 0) {
                    finalScores[category] = Math.round(
                        scores[category].reduce((sum, val) => sum + val, 0) / scores[category].length
                    );
                } else {
                    finalScores[category] = 60;
                }
            });

            // Calculate overall score
            finalScores.overall = Math.round(
                (finalScores.physical + finalScores.mental + finalScores.nutrition + finalScores.lifeSkills) / 4
            );

            console.log('Calculated baseline scores:', finalScores);

            // Save to user's assessment results
            const userProfile = JSON.parse(localStorage.getItem('userProfile') || '{}');
            localStorage.setItem(`assessment_${userProfile.id}`, JSON.stringify({
                ...finalScores,
                completedAt: new Date().toISOString(),
                type: 'baseline',
                responses: responses
            }));

            // Initialize wellness data with these scores
            const wellnessData = {
                user: {
                    name: userProfile.name,
                    school: userProfile.school,
                    yearLevel: userProfile.yearLevel,
                    userId: userProfile.id,
                    joinDate: new Date().toISOString(),
                    lastActive: new Date().toISOString()
                },
                scores: finalScores,
                activities: [{
                    id: Date.now(),
                    type: 'baseline_assessment',
                    category: 'general',
                    description: 'Completed baseline wellness assessment',
                    points: 25,
                    timestamp: new Date().toISOString()
                }],
                customGoals: [],
                achievements: {
                    first_login: true,
                    assessment_complete: true
                }
            };

            localStorage.setItem('wellnessData', JSON.stringify(wellnessData));
            localStorage.removeItem('needsBaselineAssessment');

            showResults(finalScores);
        }

        function showResults(scores) {
            const container = document.getElementById('questionsContainer');
            
            const getScoreColor = (score) => {
                if (score >= 80) return '#27ae60';
                if (score >= 60) return '#f39c12';
                if (score >= 40) return '#e67e22';
                return '#e74c3c';
            };

            const getScoreMessage = (overall) => {
                if (overall >= 80) return "Outstanding baseline! You're starting with strong wellness habits.";
                if (overall >= 60) return "Good foundation! You have solid wellness habits to build upon.";
                if (overall >= 40) return "Balanced starting point. There's great potential for growth ahead.";
                return "Perfect opportunity to develop new wellness habits with Vivify!";
            };

            container.innerHTML = `
                <div class="results-container">
                    <h2>Assessment Complete!</h2>
                    
                    <div style="background: #222; border-radius: 12px; padding: 2rem; margin-bottom: 2rem;">
                        <h3 style="color: #f39c12; margin-bottom: 1.5rem; text-align: center;">Your Baseline Wellness Scores</h3>
                        
                        <div class="scores-grid">
                            <div class="score-item">
                                <div class="score-value" style="color: ${getScoreColor(scores.physical)};">${scores.physical}%</div>
                                <div class="score-label">Physical Health</div>
                            </div>
                            <div class="score-item">
                                <div class="score-value" style="color: ${getScoreColor(scores.mental)};">${scores.mental}%</div>
                                <div class="score-label">Mental Health</div>
                            </div>
                            <div class="score-item">
                                <div class="score-value" style="color: ${getScoreColor(scores.nutrition)};">${scores.nutrition}%</div>
                                <div class="score-label">Nutrition</div>
                            </div>
                            <div class="score-item">
                                <div class="score-value" style="color: ${getScoreColor(scores.lifeSkills)};">${scores.lifeSkills}%</div>
                                <div class="score-label">Life Skills</div>
                            </div>
                        </div>
                        
                        <div class="overall-score-display">
                            <div style="font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem;">${scores.overall}%</div>
                            <div style="font-weight: 600;">Overall Wellness Score</div>
                        </div>
                        
                        <div style="background: #2a2a2a; border-radius: 8px; padding: 1.5rem; margin-top: 1.5rem;">
                            <h4 style="color: #f39c12; margin-bottom: 1rem;">What This Means</h4>
                            <p style="color: #ccc; margin-bottom: 1rem;">${getScoreMessage(scores.overall)}</p>
                            <div style="background: #333; padding: 1rem; border-radius: 6px; border-left: 4px solid #f39c12;">
                                <p style="color: #ccc; margin: 0; font-size: 0.9rem;">
                                    <strong>Remember:</strong> These baseline scores help us understand where you're starting from. 
                                    Every student's journey is unique, and you can improve these scores by completing 
                                    activities, following our programs, and building healthy habits!
                                </p>
                            </div>
                        </div>

                        <div style="margin-top: 2rem;">
                            <h4 style="color: #f39c12; margin-bottom: 1rem;">What's Next?</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
                                    <i class="fas fa-dumbbell" style="font-size: 1.5rem; color: #e74c3c; margin-bottom: 0.5rem;"></i>
                                    <h5 style="margin: 0.5rem 0; color: #fff;">Fitness Programs</h5>
                                    <p style="color: #ccc; font-size: 0.8rem; margin: 0;">Exercise routines designed for students</p>
                                </div>
                                <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
                                    <i class="fas fa-leaf" style="font-size: 1.5rem; color: #27ae60; margin-bottom: 0.5rem;"></i>
                                    <h5 style="margin: 0.5rem 0; color: #fff;">Mental Health</h5>
                                    <p style="color: #ccc; font-size: 0.8rem; margin: 0;">Mindfulness and stress management tools</p>
                                </div>
                                <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
                                    <i class="fas fa-apple-alt" style="font-size: 1.5rem; color: #2ecc71; margin-bottom: 0.5rem;"></i>
                                    <h5 style="margin: 0.5rem 0; color: #fff;">Nutrition</h5>
                                    <p style="color: #ccc; font-size: 0.8rem; margin: 0;">Healthy eating guides and recipes</p>
                                </div>
                                <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
                                    <i class="fas fa-graduation-cap" style="font-size: 1.5rem; color: #9b59b6; margin-bottom: 0.5rem;"></i>
                                    <h5 style="margin: 0.5rem 0; color: #fff;">Life Skills</h5>
                                    <p style="color: #ccc; font-size: 0.8rem; margin: 0;">Financial literacy and practical skills</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Update buttons
            document.querySelector('.assessment-buttons').innerHTML = `
                <button class="btn-primary" onclick="goToDashboard()" style="padding: 0.75rem 2rem; font-size: 1.1rem;">
                    <i class="fas fa-arrow-right"></i> Continue to Dashboard
                </button>
            `;
        }

        function goToDashboard() {
            // Show loading message
            const btn = document.querySelector('.assessment-buttons button');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Setting up your dashboard...';
            btn.disabled = true;
            
            setTimeout(() => {
                window.location.href = 'dashboard.html';
            }, 1500);
        }

        // Allow Enter key to advance questions
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                if (currentQuestionIndex === baselineQuestions.length - 1) {
                    const completeBtn = document.getElementById('completeBtn');
                    if (completeBtn.style.display !== 'none') {
                        completeAssessment();
                    }
                } else {
                    const nextBtn = document.getElementById('nextBtn');
                    if (nextBtn.style.display !== 'none') {
                        nextQuestion();
                    }
                }
            }
        });
        function loadQuestion() {
            const question = baselineQuestions[currentQuestionIndex];
            const container = document.getElementById('questionsContainer');
            
            container.innerHTML = `
                <div class="question-card">
                    <h3>${question.text}</h3>
                    <div class="options-grid">
                        ${question.options.map((option, index) => `
                            <div class="option-label" data-value="${option.value}">
                                <span>${option.text}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // Add click handling for the option boxes
            const labels = container.querySelectorAll('.option-label');
            labels.forEach(label => {
                label.addEventListener('click', () => {
                    // Remove selected class from all options
                    labels.forEach(l => l.classList.remove('selected'));
                    // Add selected class to clicked option
                    label.classList.add('selected');
                    // Store the selected value
                    label.setAttribute('data-selected', 'true');
                });
                
                label.addEventListener('mouseenter', () => {
                    if (!label.classList.contains('selected')) {
                        label.style.borderColor = '#f39c12';
                        label.style.background = '#3a3a3a';
                    }
                });
                
                label.addEventListener('mouseleave', () => {
                    if (!label.classList.contains('selected')) {
                        label.style.borderColor = '#555';
                        label.style.background = '#333';
                    }
                });
            });

            updateProgress();
            updateButtons();
        }
        function nextQuestion() {
            const selectedOption = document.querySelector('.option-label.selected');
            
            if (!selectedOption) {
                alert('Please select an answer before continuing.');
                return;
            }

            responses[currentQuestionIndex] = {
                question: baselineQuestions[currentQuestionIndex].text,
                category: baselineQuestions[currentQuestionIndex].category,
                value: parseInt(selectedOption.dataset.value),
                answer: selectedOption.textContent.trim()
            };

            if (currentQuestionIndex < baselineQuestions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
                
                // Restore previous selection
                if (responses[currentQuestionIndex]) {
                    const value = responses[currentQuestionIndex].value;
                    const targetOption = document.querySelector(`.option-label[data-value="${value}"]`);
                    if (targetOption) {
                        targetOption.classList.add('selected');
                    }
                }
            }
        }

        function completeAssessment() {
            const selectedOption = document.querySelector('.option-label.selected');
            
            if (!selectedOption) {
                alert('Please answer the final question.');
                return;
            }

            responses[currentQuestionIndex] = {
                question: baselineQuestions[currentQuestionIndex].text,
                category: baselineQuestions[currentQuestionIndex].category,
                value: parseInt(selectedOption.dataset.value),
                answer: selectedOption.textContent.trim()
            };

            calculateBaselineScores();
        }
    </script>
</body>
</html>