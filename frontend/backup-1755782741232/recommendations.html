<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recommendations - Vivify</title>
    
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #0a0a0a;
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .wrapper {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        main {
            flex: 1;
        }

        /* Footer Styling */
        footer {
            background-color: #000;
            color: white;
            text-align: center;
            padding: 2rem 0;
            width: 100%;
            margin-top: auto;
            border-top: 1px solid #333;
        }

        footer .footer-links {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 1rem 0 0 0;
            padding: 0;
        }

        footer .footer-links a {
            color: #a0a0a0;
            text-decoration: none;
            transition: color 0.3s;
        }

        footer .footer-links a:hover {
            color: #f39c12;
        }

        .recommendations-hero {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 6rem 2rem;
            text-align: center;
        }

        .recommendations-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .recommendations-hero p {
            font-size: 1.25rem;
            max-width: 800px;
            margin: 0 auto 2rem;
        }

        .recommendations-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .section-title {
            color: #f39c12;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #333;
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .main-recommendations {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        /* Profile Assessment Card */
        .assessment-card {
            background: linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
        }

        .assessment-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 2rem;
            color: #000;
        }

        .assessment-card h3 {
            color: #f39c12;
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }

        .assessment-card p {
            color: #d0d0d0;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .assessment-btn {
            background: #f39c12;
            color: #000;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .assessment-btn:hover {
            background: #e67e22;
            transform: translateY(-1px);
        }

        /* Quick Filters */
        .filters-card {
            background-color: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 1.5rem;
        }

        .filter-group {
            margin-bottom: 1.5rem;
        }

        .filter-label {
            color: #f39c12;
            font-weight: 500;
            margin-bottom: 0.75rem;
            display: block;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .filter-option:hover {
            background-color: #333;
        }

        .filter-checkbox {
            width: 16px;
            height: 16px;
            border: 2px solid #444;
            border-radius: 3px;
            position: relative;
            transition: all 0.3s ease;
        }

        .filter-checkbox.checked {
            background-color: #f39c12;
            border-color: #f39c12;
        }

        .filter-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: -2px;
            left: 1px;
            color: #000;
            font-size: 12px;
            font-weight: bold;
        }

        .filter-text {
            color: #d0d0d0;
            font-size: 0.9rem;
        }

        /* Recommendation Cards */
        .recommendation-section {
            margin-bottom: 3rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .section-header h2 {
            color: #f39c12;
            font-size: 2rem;
            margin: 0;
        }

        .section-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: rgba(243, 156, 18, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #f39c12;
        }

        .recommendations-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
        }

        .recommendation-card {
            background-color: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .recommendation-card:hover {
            border-color: #444;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid #333;
        }

        .card-title {
            color: #ffffff;
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0 0 0.5rem 0;
            line-height: 1.4;
        }

        .card-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .card-badge {
            background: rgba(243, 156, 18, 0.15);
            color: #f39c12;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .card-rating {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            color: #f39c12;
        }

        .card-content {
            padding: 1.5rem;
        }

        .card-description {
            color: #d0d0d0;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .card-details {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        .detail-icon {
            color: #f39c12;
            font-size: 0.8rem;
        }

        .card-actions {
            display: flex;
            gap: 1rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.75rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: #f39c12;
            color: #000;
            border: none;
        }

        .btn-primary:hover {
            background: #e67e22;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: transparent;
            color: #f39c12;
            border: 1px solid #f39c12;
        }

        .btn-secondary:hover {
            background: rgba(243, 156, 18, 0.1);
        }

        /* Priority Badge */
        .priority-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #e74c3c;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
        }

        .priority-high { background: #e74c3c; }
        .priority-medium { background: #f39c12; color: #000; }
        .priority-low { background: #27ae60; }

        /* Personalized Section */
        .personalized-section {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 3rem;
            border: 1px solid #34495e;
        }

        .personalized-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .personalized-header h2 {
            color: #f39c12;
            margin-bottom: 0.5rem;
        }

        .personalized-header p {
            color: #ecf0f1;
            margin: 0;
        }

        .performance-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .score-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }

        .score-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: block;
        }

        .score-physical { color: #e74c3c; }
        .score-mental { color: #3498db; }
        .score-nutrition { color: #27ae60; }
        .score-skills { color: #9b59b6; }

        .score-label {
            color: #ecf0f1;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Loading States */
        .loading {
            text-align: center;
            padding: 3rem;
            color: #a0a0a0;
        }

        .loading i {
            font-size: 2rem;
            margin-bottom: 1rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #a0a0a0;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #333;
        }

        /* Location Specific */
        .location-badge {
            background: rgba(52, 152, 219, 0.15);
            color: #3498db;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-left: 0.5rem;
        }

        /* Assessment Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-content {
            background: linear-gradient(145deg, #1e1e1e 0%, #2a2a2a 100%);
            margin: 5% auto;
            padding: 2rem;
            border: 1px solid #333;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            color: #f39c12;
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
        }

        .close {
            color: #a0a0a0;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .close:hover {
            color: #ffffff;
        }

        .question-item {
            margin-bottom: 2rem;
        }

        .question-text {
            color: #ffffff;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .question-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .option-btn {
            background: #333;
            border: 2px solid #444;
            color: #d0d0d0;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .option-btn:hover {
            border-color: #f39c12;
            background: rgba(243, 156, 18, 0.1);
        }

        .option-btn.selected {
            border-color: #f39c12;
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .recommendations-grid {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .recommendations-hero h1 {
                font-size: 2.5rem;
            }
            
            .recommendations-container {
                padding: 2rem 1rem;
            }
            
            .recommendations-list {
                grid-template-columns: 1fr;
            }
            
            .card-actions {
                flex-direction: column;
            }
            
            .performance-scores {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .recommendations-hero {
                padding: 4rem 1rem;
            }
            
            .recommendation-card {
                margin-bottom: 1rem;
            }
            
            .performance-scores {
                grid-template-columns: 1fr;
            }
        }
    @media (max-width: 768px) {
            /* FORCE hide all desktop navigation */
            nav ul,
            nav li,
            .left-nav ul,
            .right-nav ul,
            .left-nav li,
            .right-nav li,
            .left-nav > ul,
            .right-nav > ul {
                display: none !important;
                visibility: hidden !important;
            }
            
            /* Ensure nav container works properly */
            nav {
                display: flex !important;
                justify-content: space-between !important;
                align-items: center !important;
                padding: 1rem !important;
                flex-wrap: nowrap !important;
            }
            
            /* Keep logo visible */
            .logo,
            .logo a {
                display: block !important;
                visibility: visible !important;
                font-size: 1.5rem !important;
                white-space: nowrap !important;
            }
            
            /* Force show mobile button if it exists */
            .mobile-menu-btn {
                display: flex !important;
                visibility: visible !important;
                flex-direction: column;
                background: none;
                border: none;
                cursor: pointer;
                padding: 0.5rem;
                z-index: 1001;
            }
            
            /* Mobile button styles */
            .mobile-menu-btn .hamburger {
                width: 25px;
                height: 3px;
                background: #ffffff;
                margin: 3px 0;
                transition: 0.3s;
                border-radius: 2px;
            }
            
            /* Ensure right-nav container shows mobile button */
            .right-nav {
                display: flex !important;
                align-items: center !important;
                visibility: visible !important;
            }
        }

        /* If no mobile button exists, add this emergency button */
        @media (max-width: 768px) {
            nav:not(:has(.mobile-menu-btn))::after {
                content: "☰";
                position: absolute;
                right: 1rem;
                top: 50%;
                transform: translateY(-50%);
                color: white;
                font-size: 1.5rem;
                cursor: pointer;
            }
        }
        .mobile-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(10, 10, 10, 0.98);
            backdrop-filter: blur(20px);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-menu.active {
            opacity: 1;
            visibility: visible;
        }

        .mobile-menu-content {
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 2rem;
        }

        .mobile-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 2rem;
        }

        .mobile-menu-close {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 2rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        .mobile-menu-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .mobile-menu-link {
            color: #ffffff;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .mobile-menu-link:hover {
            color: #f39c12;
            padding-left: 1rem;
        }

        .mobile-menu-link.mobile-cta {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: #000 !important;
            border-radius: 12px;
            margin-top: 1rem;
            text-align: center;
            font-weight: 600;
            border: none;
        }

        .mobile-menu-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 1rem 0;
        }

        .mobile-menu-btn.active .hamburger:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }

        .mobile-menu-btn.active .hamburger:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-btn.active .hamburger:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }

        /* Add this to your CSS to ensure mobile elements are hidden on desktop */
        @media (min-width: 769px) {
            .mobile-menu,
            .mobile-menu-btn {
                display: none !important;
                visibility: hidden !important;
            }
        }
    </style>
    <script>
        // Authentication-aware mobile menu
function createMobileMenu() {
    // Only create mobile menu on mobile devices
    if (window.innerWidth > 768) {
        return; // Exit early on desktop
    }
    
    // Check authentication status
    const authToken = localStorage.getItem('authToken');
    const userLoggedIn = localStorage.getItem('userLoggedIn');
    const isLoggedIn = !!(authToken || userLoggedIn === 'true');
    const username = localStorage.getItem('username') || 'User';
    
    console.log('Auth check:', { authToken, userLoggedIn, isLoggedIn, username }); // Debug log
    
    // Create mobile menu if it doesn't exist
    if (!document.getElementById('mobile-menu')) {
        const header = document.querySelector('header');
        const mobileMenu = document.createElement('div');
        mobileMenu.id = 'mobile-menu';
        mobileMenu.className = 'mobile-menu';
        
        // Generate auth-specific menu items
        let authMenuItems = '';
        if (isLoggedIn) {
            authMenuItems = `
                <div class="mobile-menu-divider"></div>
                <div class="mobile-user-info">
                    <span style="color: #f39c12; font-weight: 600; padding: 0.5rem 0;">Welcome, ${username}!</span>
                </div>
                <a href="dashboard.html" class="mobile-menu-link mobile-cta">Dashboard</a>
                <a href="profile.html" class="mobile-menu-link">Profile</a>
                <a href="#" class="mobile-menu-link" onclick="handleMobileLogout(event)">Logout</a>
            `;
        } else {
            authMenuItems = `
                <div class="mobile-menu-divider"></div>
                <a href="login.html" class="mobile-menu-link">Login</a>
                <a href="signup.html" class="mobile-menu-link mobile-cta">Start Training</a>
            `;
        }
        
        mobileMenu.innerHTML = `
            <div class="mobile-menu-content">
                <div class="mobile-menu-header">
                    <div class="logo"><a href="index.html">Vivify</a></div>
                    <button class="mobile-menu-close" onclick="closeMobileMenu()">×</button>
                </div>
                <div class="mobile-menu-links">
                    <a href="index.html" class="mobile-menu-link">Home</a>
                    <a href="index.html#training" class="mobile-menu-link">Training Areas</a>
                    <a href="habits-tracker.html" class="mobile-menu-link">Habits</a>
                    <a href="challenges.html" class="mobile-menu-link">Challenges</a>
                    <a href="about.html" class="mobile-menu-link">About</a>
                    <a href="community.html" class="mobile-menu-link">Community</a>
                    ${authMenuItems}
                </div>
            </div>
        `;
        header.appendChild(mobileMenu);
    }
    
    // Create mobile button if it doesn't exist
    if (!document.getElementById('mobile-menu-btn')) {
        const nav = document.querySelector('nav');
        const rightNav = nav.querySelector('.right-nav') || nav;
        const mobileBtn = document.createElement('button');
        mobileBtn.id = 'mobile-menu-btn';
        mobileBtn.className = 'mobile-menu-btn';
        mobileBtn.onclick = toggleMobileMenu;
        mobileBtn.innerHTML = `
            <span class="hamburger"></span>
            <span class="hamburger"></span>
            <span class="hamburger"></span>
        `;
        rightNav.appendChild(mobileBtn);
    }
}

function handleMobileLogout(event) {
    event.preventDefault();
    if (confirm('Are you sure you want to logout?')) {
        // Clear all auth data
        localStorage.clear();
        
        // Close mobile menu
        closeMobileMenu();
        
        // Refresh the page to update UI
        window.location.reload();
    }
}

function toggleMobileMenu() {
    const menu = document.getElementById('mobile-menu');
    const btn = document.getElementById('mobile-menu-btn');
    
    menu.classList.toggle('active');
    btn.classList.toggle('active');
    
    if (menu.classList.contains('active')) {
        document.body.style.overflow = 'hidden';
    } else {
        document.body.style.overflow = '';
    }
}

function closeMobileMenu() {
    const menu = document.getElementById('mobile-menu');
    const btn = document.getElementById('mobile-menu-btn');
    
    menu.classList.remove('active');
    btn.classList.remove('active');
    document.body.style.overflow = '';
}

// Function to update mobile menu when auth state changes
function updateMobileMenuAuth() {
    const existingMenu = document.getElementById('mobile-menu');
    if (existingMenu) {
        existingMenu.remove();
    }
    createMobileMenu();
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', createMobileMenu);

// Listen for auth state changes (if you have an auth system that fires events)
window.addEventListener('authStateChanged', updateMobileMenuAuth);

// Export functions for external use
window.updateMobileMenuAuth = updateMobileMenuAuth;
window.handleMobileLogout = handleMobileLogout;
// Add this at the end of your mobile menu script
window.addEventListener('resize', function() {
    if (window.innerWidth > 768) {
        // Remove mobile elements on desktop
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileBtn = document.getElementById('mobile-menu-btn');
        
        if (mobileMenu) mobileMenu.remove();
        if (mobileBtn) mobileBtn.remove();
        
        // Reset body overflow
        document.body.style.overflow = '';
    } else if (window.innerWidth <= 768) {
        // Recreate mobile menu if switching to mobile
        const existingMenu = document.getElementById('mobile-menu');
        if (!existingMenu) {
            createMobileMenu();
        }
    }
});
        </script>
<!-- CSS Loading Order Fix -->

<link rel="stylesheet" href="styles.css">

<!-- FOUC Prevention -->
<style>
    html { visibility: hidden; opacity: 0; }
    html.loaded { visibility: visible; opacity: 1; transition: opacity 0.3s ease; }
@media (max-width: 768px) {
            /* FORCE hide all desktop navigation */
            nav ul,
            nav li,
            .left-nav ul,
            .right-nav ul,
            .left-nav li,
            .right-nav li,
            .left-nav > ul,
            .right-nav > ul {
                display: none !important;
                visibility: hidden !important;
            }
            
            /* Ensure nav container works properly */
            nav {
                display: flex !important;
                justify-content: space-between !important;
                align-items: center !important;
                padding: 1rem !important;
                flex-wrap: nowrap !important;
            }
            
            /* Keep logo visible */
            .logo,
            .logo a {
                display: block !important;
                visibility: visible !important;
                font-size: 1.5rem !important;
                white-space: nowrap !important;
            }
            
            /* Force show mobile button if it exists */
            .mobile-menu-btn {
                display: flex !important;
                visibility: visible !important;
                flex-direction: column;
                background: none;
                border: none;
                cursor: pointer;
                padding: 0.5rem;
                z-index: 1001;
            }
            
            /* Mobile button styles */
            .mobile-menu-btn .hamburger {
                width: 25px;
                height: 3px;
                background: #ffffff;
                margin: 3px 0;
                transition: 0.3s;
                border-radius: 2px;
            }
            
            /* Ensure right-nav container shows mobile button */
            .right-nav {
                display: flex !important;
                align-items: center !important;
                visibility: visible !important;
            }
        }

        /* If no mobile button exists, add this emergency button */
        @media (max-width: 768px) {
            nav:not(:has(.mobile-menu-btn))::after {
                content: "☰";
                position: absolute;
                right: 1rem;
                top: 50%;
                transform: translateY(-50%);
                color: white;
                font-size: 1.5rem;
                cursor: pointer;
            }
        }
        .mobile-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(10, 10, 10, 0.98);
            backdrop-filter: blur(20px);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-menu.active {
            opacity: 1;
            visibility: visible;
        }

        .mobile-menu-content {
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 2rem;
        }

        .mobile-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 3rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 2rem;
        }

        .mobile-menu-close {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 2rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        .mobile-menu-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .mobile-menu-link {
            color: #ffffff;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 500;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .mobile-menu-link:hover {
            color: #f39c12;
            padding-left: 1rem;
        }

        .mobile-menu-link.mobile-cta {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: #000 !important;
            border-radius: 12px;
            margin-top: 1rem;
            text-align: center;
            font-weight: 600;
            border: none;
        }

        .mobile-menu-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 1rem 0;
        }

        .mobile-menu-btn.active .hamburger:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }

        .mobile-menu-btn.active .hamburger:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-btn.active .hamburger:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }

        /* Add this to your CSS to ensure mobile elements are hidden on desktop */
        @media (min-width: 769px) {
            .mobile-menu,
            .mobile-menu-btn {
                display: none !important;
                visibility: hidden !important;
            }
        }
    </style>
    <script>
        // Authentication-aware mobile menu
function createMobileMenu() {
    // Only create mobile menu on mobile devices
    if (window.innerWidth > 768) {
        return; // Exit early on desktop
    }
    
    // Check authentication status
    const authToken = localStorage.getItem('authToken');
    const userLoggedIn = localStorage.getItem('userLoggedIn');
    const isLoggedIn = !!(authToken || userLoggedIn === 'true');
    const username = localStorage.getItem('username') || 'User';
    
    console.log('Auth check:', { authToken, userLoggedIn, isLoggedIn, username }); // Debug log
    
    // Create mobile menu if it doesn't exist
    if (!document.getElementById('mobile-menu')) {
        const header = document.querySelector('header');
        const mobileMenu = document.createElement('div');
        mobileMenu.id = 'mobile-menu';
        mobileMenu.className = 'mobile-menu';
        
        // Generate auth-specific menu items
        let authMenuItems = '';
        if (isLoggedIn) {
            authMenuItems = `
                <div class="mobile-menu-divider"></div>
                <div class="mobile-user-info">
                    <span style="color: #f39c12; font-weight: 600; padding: 0.5rem 0;">Welcome, ${username}!</span>
                </div>
                <a href="dashboard.html" class="mobile-menu-link mobile-cta">Dashboard</a>
                <a href="profile.html" class="mobile-menu-link">Profile</a>
                <a href="#" class="mobile-menu-link" onclick="handleMobileLogout(event)">Logout</a>
            `;
        } else {
            authMenuItems = `
                <div class="mobile-menu-divider"></div>
                <a href="login.html" class="mobile-menu-link">Login</a>
                <a href="signup.html" class="mobile-menu-link mobile-cta">Start Training</a>
            `;
        }
        
        mobileMenu.innerHTML = `
            <div class="mobile-menu-content">
                <div class="mobile-menu-header">
                    <div class="logo"><a href="index.html">Vivify</a></div>
                    <button class="mobile-menu-close" onclick="closeMobileMenu()">×</button>
                </div>
                <div class="mobile-menu-links">
                    <a href="index.html" class="mobile-menu-link">Home</a>
                    <a href="index.html#training" class="mobile-menu-link">Training Areas</a>
                    <a href="habits-tracker.html" class="mobile-menu-link">Habits</a>
                    <a href="challenges.html" class="mobile-menu-link">Challenges</a>
                    <a href="about.html" class="mobile-menu-link">About</a>
                    <a href="community.html" class="mobile-menu-link">Community</a>
                    ${authMenuItems}
                </div>
            </div>
        `;
        header.appendChild(mobileMenu);
    }
    
    // Create mobile button if it doesn't exist
    if (!document.getElementById('mobile-menu-btn')) {
        const nav = document.querySelector('nav');
        const rightNav = nav.querySelector('.right-nav') || nav;
        const mobileBtn = document.createElement('button');
        mobileBtn.id = 'mobile-menu-btn';
        mobileBtn.className = 'mobile-menu-btn';
        mobileBtn.onclick = toggleMobileMenu;
        mobileBtn.innerHTML = `
            <span class="hamburger"></span>
            <span class="hamburger"></span>
            <span class="hamburger"></span>
        `;
        rightNav.appendChild(mobileBtn);
    }
}

function handleMobileLogout(event) {
    event.preventDefault();
    if (confirm('Are you sure you want to logout?')) {
        // Clear all auth data
        localStorage.clear();
        
        // Close mobile menu
        closeMobileMenu();
        
        // Refresh the page to update UI
        window.location.reload();
    }
}

function toggleMobileMenu() {
    const menu = document.getElementById('mobile-menu');
    const btn = document.getElementById('mobile-menu-btn');
    
    menu.classList.toggle('active');
    btn.classList.toggle('active');
    
    if (menu.classList.contains('active')) {
        document.body.style.overflow = 'hidden';
    } else {
        document.body.style.overflow = '';
    }
}

function closeMobileMenu() {
    const menu = document.getElementById('mobile-menu');
    const btn = document.getElementById('mobile-menu-btn');
    
    menu.classList.remove('active');
    btn.classList.remove('active');
    document.body.style.overflow = '';
}

// Function to update mobile menu when auth state changes
function updateMobileMenuAuth() {
    const existingMenu = document.getElementById('mobile-menu');
    if (existingMenu) {
        existingMenu.remove();
    }
    createMobileMenu();
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', createMobileMenu);

// Listen for auth state changes (if you have an auth system that fires events)
window.addEventListener('authStateChanged', updateMobileMenuAuth);

// Export functions for external use
window.updateMobileMenuAuth = updateMobileMenuAuth;
window.handleMobileLogout = handleMobileLogout;
// Add this at the end of your mobile menu script
window.addEventListener('resize', function() {
    if (window.innerWidth > 768) {
        // Remove mobile elements on desktop
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileBtn = document.getElementById('mobile-menu-btn');
        
        if (mobileMenu) mobileMenu.remove();
        if (mobileBtn) mobileBtn.remove();
        
        // Reset body overflow
        document.body.style.overflow = '';
    } else if (window.innerWidth <= 768) {
        // Recreate mobile menu if switching to mobile
        const existingMenu = document.getElementById('mobile-menu');
        if (!existingMenu) {
            createMobileMenu();
        }
    }
});
        </script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.documentElement.classList.add('loaded');
    });
    window.addEventListener('load', function() {
        document.documentElement.classList.add('loaded');
    });
</script>
<script src="js/vivify-stats.js"></script>
<script src="js/leaderboard-system.js"></script>
</head>
<body>
    <div class="wrapper">
        <header>
            <nav>
                <div class="left-nav">
                    <div class="logo">
                        <a href="index.html" aria-label="Home Page"><h1>Vivify</h1></a>
                    </div>
                    <ul>
                        <li><a href="about.html" aria-label="About Us Page">About</a></li>
                        <li class="dropdown" id="categoryDropdown">
                            <a href="#" class="dropbtn" aria-label="Categories Dropdown">Training</a>
                            <div class="dropdown-content">
                                <a href="fitness.html" aria-label="Fitness Page">Fitness</a>
                                <a href="nutrition.html" aria-label="Nutrition Page">Nutrition</a>
                                <a href="focus-resilience.html" aria-label="Focus & Resilience Page">Focus & Resilience</a>
                                <a href="life-mastery.html" aria-label="Life Lessons Page">Life Mastery</a>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="right-nav">
                    <ul>
                        <li><a href="dashboard.html" id="dashboardLink" aria-label="Dashboard">Performance Hub</a></li>
                        <li><a href="profile.html" id="profileLink" aria-label="Profile Page">Profile</a></li>
                        <li><a href="#" id="logoutLink" aria-label="Logout">Logout</a></li>
                        <li><a href="login.html" id="loginLink" style="display: none;" aria-label="Login Page">Login</a></li>
                        <li><a href="signup.html" id="signupLink" style="display: none;" aria-label="Sign Up Page">Sign Up</a></li>
                    </ul>
                </div>
            </nav>
        </header>

        <main>
            <!-- Hero Section -->
            <section class="recommendations-hero">
                <h1>Smart Recommendations</h1>
                <p>Get personalised suggestions for your performance journey based on your goals, location, and lifestyle. From local gyms to Focus & Resilience resources, we'll help you find what you need.</p>
            </section>

            <!-- Main Content -->
            <div class="recommendations-container">
                <div class="recommendations-grid">
                    <!-- Sidebar -->
                    <div class="sidebar">
                        <!-- Assessment Card -->
                        <div class="assessment-card">
                            <div class="assessment-icon">
                                <i class="fas fa-clipboard-check"></i>
                            </div>
                            <h3>performance Assessment</h3>
                            <p>Take our quick assessment to get better personalised recommendations based on your current performance goals and lifestyle.</p>
                            <button class="assessment-btn" onclick="startAssessment()">
                                <i class="fas fa-play"></i> Start Assessment
                            </button>
                        </div>

                        <!-- Filters -->
                        <div class="filters-card">
                            <h3 style="color: #f39c12; margin-bottom: 1.5rem;">Filter Recommendations</h3>
                            
                            <div class="filter-group">
                                <label class="filter-label">Training</label>
                                <div class="filter-options">
                                    <div class="filter-option" onclick="toggleFilter(this, 'fitness')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Fitness & Exercise</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'nutrition')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Nutrition & Diet</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'mental-health')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Focus & Resilience</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'life-skills')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Life Skills</span>
                                    </div>
                                </div>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Location</label>
                                <div class="filter-options">
                                    <div class="filter-option" onclick="toggleFilter(this, 'sydney')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Sydney</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'melbourne')">
                                        <div class="filter-checkbox"></div>
                                        <span class="filter-text">Melbourne</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'brisbane')">
                                        <div class="filter-checkbox"></div>
                                        <span class="filter-text">Brisbane</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'online')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Online</span>
                                    </div>
                                </div>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Budget</label>
                                <div class="filter-options">
                                    <div class="filter-option" onclick="toggleFilter(this, 'free')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Free</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'budget')">
                                        <div class="filter-checkbox checked"></div>
                                        <span class="filter-text">Budget-friendly</span>
                                    </div>
                                    <div class="filter-option" onclick="toggleFilter(this, 'premium')">
                                        <div class="filter-checkbox"></div>
                                        <span class="filter-text">Premium</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Recommendations -->
                    <div class="main-recommendations">
                        <!-- Personalized Section -->
                        <div class="personalized-section">
                            <div class="personalized-header">
                                <h2><i class="fas fa-user-check"></i> Your performance Profile</h2>
                                <p>Based on your current performance scores and recent activities</p>
                            </div>
                            
                            <div class="performance-scores" id="performanceScores">
                                <div class="score-item">
                                    <span class="score-value score-physical" id="physicalScore">0</span>
                                    <div class="score-label">Physical</div>
                                </div>
                                <div class="score-item">
                                    <span class="score-value score-mental" id="mentalScore">0</span>
                                    <div class="score-label">Mental</div>
                                </div>
                                <div class="score-item">
                                    <span class="score-value score-nutrition" id="nutritionScore">0</span>
                                    <div class="score-label">Nutrition</div>
                                </div>
                                <div class="score-item">
                                    <span class="score-value score-skills" id="skillsScore">0</span>
                                    <div class="score-label">Life Skills</div>
                                </div>
                            </div>
                        </div>

                        <!-- Priority Recommendations -->
                        <div class="recommendation-section">
                            <div class="section-header">
                                <div class="section-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <h2>Priority Recommendations</h2>
                            </div>
                            <div class="recommendations-list" id="priorityRecommendations">
                                <!-- Priority recommendations will be loaded here -->
                            </div>
                        </div>

                        <!-- Fitness Recommendations -->
                        <div class="recommendation-section">
                            <div class="section-header">
                                <div class="section-icon">
                                    <i class="fas fa-dumbbell"></i>
                                </div>
                                <h2>Fitness & Exercise</h2>
                            </div>
                            <div class="recommendations-list" id="fitnessRecommendations">
                                <!-- Fitness recommendations will be loaded here -->
                            </div>
                        </div>

                        <!-- Focus & Resilience Recommendations -->
                        <div class="recommendation-section">
                            <div class="section-header">
                                <div class="section-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <h2>Focus & Resilience & Wellbeing</h2>
                            </div>
                            <div class="recommendations-list" id="mentalHealthRecommendations">
                                <!-- Focus & Resilience recommendations will be loaded here -->
                            </div>
                        </div>

                        <!-- Nutrition Recommendations -->
                        <div class="recommendation-section">
                            <div class="section-header">
                                <div class="section-icon">
                                    <i class="fas fa-apple-alt"></i>
                                </div>
                                <h2>Nutrition & Diet</h2>
                            </div>
                            <div class="recommendations-list" id="nutritionRecommendations">
                                <!-- Nutrition recommendations will be loaded here -->
                            </div>
                        </div>

                        <!-- Life Skills Recommendations -->
                        <div class="recommendation-section">
                            <div class="section-header">
                                <div class="section-icon">
                                    <i class="fas fa-graduation-cap"></i>
                                </div>
                                <h2>Life Skills & Financial Literacy</h2>
                            </div>
                            <div class="recommendations-list" id="lifeSkillsRecommendations">
                                <!-- Life skills recommendations will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Assessment Modal -->
        <div id="assessmentModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">performance Assessment</h3>
                    <span class="close" onclick="closeAssessment()">&times;</span>
                </div>
                <div id="assessmentContent">
                    <!-- Assessment questions will be loaded here -->
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2024 Vivify. All rights reserved.</p>
            <ul class="footer-links">
                <li><a href="privacy.html" aria-label="Privacy Policy">Privacy Policy</a></li>
                <li><a href="terms.html" aria-label="Terms of Service">Terms of Service</a></li>
                <li><a href="contact.html" aria-label="Contact Us">Contact Us</a></li>
            </ul>
        </footer>
    </div>

    <script>
        // Sample recommendations data
        const recommendationsData = {
            priority: [
                {
                    id: 1,
                    title: "Headspace for Students",
                    description: "Free meditation and mindfulness app specifically designed for students. Includes guided meditations for stress, focus, and better sleep.",
                    category: "mental-health",
                    location: "Online",
                    rating: 4.8,
                    priority: "high",
                    cost: "Free for students",
                    duration: "5-20 mins",
                    type: "App"
                },
                {
                    id: 2,
                    title: "University of Sydney Gym",
                    description: "Student-friendly gym with affordable membership rates. Includes swimming pool, weights, cardio equipment, and group fitness classes.",
                    category: "fitness",
                    location: "Sydney",
                    rating: 4.5,
                    priority: "high",
                    cost: "$15/week",
                    duration: "Flexible",
                    type: "Gym"
                },
                {
                    id: 3,
                    title: "Budget Bytes Meal Planning",
                    description: "Website and app with budget-friendly recipes perfect for students. Includes grocery lists and meal prep guides under $5per serving.",
                    category: "nutrition",
                    location: "Online",
                    rating: 4.7,
                    priority: "medium",
                    cost: "Free",
                    duration: "30-45 mins prep",
                    type: "Website"
                }
                ],
                    fitness: [
                    {
                    id: 4,
                    title: "Centennial Park Free Fitness Equipment",
                    description: "Outdoor gym equipment in beautiful Centennial Park. Perfect for bodyweight exercises and cardio. Open 24/7 and completely free.",
                    category: "fitness",
                    location: "Sydney",
                    rating: 4.3,
                    priority: "medium",
                    cost: "Free",
                    duration: "30-60 mins",
                    type: "Outdoor Gym"
                    },
                    {
                    id: 5,
                    title: "Nike Training Club App",
                    description: "Free fitness app with workouts for all levels. No equipment needed for many workouts. Perfect for dorm room or small space exercises.",
                    category: "fitness",
                    location: "Online",
                    rating: 4.6,
                    priority: "low",
                    cost: "Free",
                    duration: "15-45 mins",
                    type: "App"
                    },
                    {
                    id: 6,
                    title: "UNSW Aquatic Centre",
                    description: "Student discounts available for swimming and water aerobics. Great low-impact exercise option with heated pools year-round.",
                    category: "fitness",
                    location: "Sydney",
                    rating: 4.4,
                    priority: "medium",
                    cost: "$8 student rate",
                    duration: "45-60 mins",
                    type: "Swimming Pool"
                    }
                    ],
                    mentalHealth: [
                    {
                    id: 7,
                    title: "Beyond Blue Online Chat",
                    description: "Free 24/7 online chat service for Focus & Resilience support. Staffed by trained counsellors who understand student life challenges.",
                    category: "mental-health",
                    location: "Online",
                    rating: 4.5,
                    priority: "high",
                    cost: "Free",
                    duration: "As needed",
                    type: "Counselling"
                    },
                    {
                    id: 8,
                    title: "University Counselling Services",
                    description: "Most Australian universities offer free counselling services to students. Professional support for stress, anxiety, and Focus & Resilience.",
                    category: "mental-health",
                    location: "All Cities",
                    rating: 4.6,
                    priority: "high",
                    cost: "Free for students",
                    duration: "50 mins",
                    type: "Counselling"
                    },
                    {
                    id: 9,
                    title: "Calm App Student Discount",
                    description: "Premium meditation app with student discounts. Includes sleep stories, guided meditations, and mindfulness exercises.",
                    category: "mental-health",
                    location: "Online",
                    rating: 4.7,
                    priority: "medium",
                    cost: "$3/month student",
                    duration: "5-30 mins",
                    type: "App"
                    }
                    ],
                    nutrition: [
                    {
                    id: 10,
                    title: "Woolworths Student Discounts",
                    description: "Student discounts on groceries with student ID. Look for weekly specials and generic brands to stretch your budget further.",
                    category: "nutrition",
                    location: "All Cities",
                    rating: 4.2,
                    priority: "medium",
                    cost: "Varies",
                    duration: "Weekly shop",
                    type: "Grocery Store"
                    },
                    {
                    id: 11,
                    title: "MyFitnessPal Food Tracking",
                    description: "Free app to track nutrition and calories. Huge database of Australian foods including major supermarket brands.",
                    category: "nutrition",
                    location: "Online",
                    rating: 4.4,
                    priority: "low",
                    cost: "Free",
                    duration: "5 mins daily",
                    type: "App"
                    },
                    {
                    id: 12,
                    title: "University Nutritionist Services",
                    description: "Many universities offer free or low-cost nutrition consultations. Get personalised advice for your dietary needs and budget.",
                    category: "nutrition",
                    location: "All Cities",
                    rating: 4.5,
                    priority: "medium",
                    cost: "Free-$20",
                    duration: "30-45 mins",
                    type: "Consultation"
                    }
                    ],
                    lifeSkills: [
                    {
                    id: 13,
                    title: "CommBank Financial Basics Course",
                    description: "Free online course covering banking, budgeting, and financial literacy basics. Perfect for students new to managing money.",
                    category: "life-skills",
                    location: "Online",
                    rating: 4.3,
                    priority: "high",
                    cost: "Free",
                    duration: "2-3 hours",
                    type: "Online Course"
                    },
                    {
                    id: 14,
                    title: "ASIC MoneySmart Website",
                    description: "Government resource for financial education. Includes budgeting tools, superannuation guides, and student-specific advice.",
                    category: "life-skills",
                    location: "Online",
                    rating: 4.6,
                    priority: "medium",
                    cost: "Free",
                    duration: "Self-paced",
                    type: "Website"
                    },
                    {
                    id: 15,
                    title: "Centrelink Youth Allowance Workshop",
                    description: "Free workshops explaining Youth Allowance eligibility and application process. Offered at most universities during orientation.",
                    category: "life-skills",
                    location: "All Cities",
                    rating: 4.4,
                    priority: "high",
                    cost: "Free",
                    duration: "90 mins",
                    type: "Workshop"
                    }
                ]
            };
            // Assessment questions
    const assessmentQuestions = [
        {
            id: 1,
            question: "How would you rate your current stress levels?",
            options: [
                { text: "Very low - I feel relaxed most of the time", value: 1 },
                { text: "Low - Occasionally stressed but manageable", value: 2 },
                { text: "Moderate - Regular stress but I cope okay", value: 3 },
                { text: "High - Often overwhelmed and stressed", value: 4 },
                { text: "Very high - Constantly stressed and struggling", value: 5 }
            ],
            category: "mental-health"
        },
        {
            id: 2,
            question: "How often do you exercise or do physical activity?",
            options: [
                { text: "Daily - I exercise every day", value: 5 },
                { text: "4-6 times per week", value: 4 },
                { text: "2-3 times per week", value: 3 },
                { text: "Once a week or less", value: 2 },
                { text: "Never - I don't exercise regularly", value: 1 }
            ],
            category: "fitness"
        },
        {
            id: 3,
            question: "How confident are you with managing your finances?",
            options: [
                { text: "Very confident - I budget and track everything", value: 5 },
                { text: "Confident - I have a good handle on my money", value: 4 },
                { text: "Somewhat confident - I try to budget", value: 3 },
                { text: "Not very confident - I struggle with money", value: 2 },
                { text: "Not confident at all - I have no budget", value: 1 }
            ],
            category: "life-skills"
        },
        {
            id: 4,
            question: "How would you describe your eating habits?",
            options: [
                { text: "Excellent - I eat balanced, healthy meals regularly", value: 5 },
                { text: "Good - Mostly healthy with occasional treats", value: 4 },
                { text: "Okay - Mix of healthy and unhealthy foods", value: 3 },
                { text: "Poor - Lots of fast food and irregular meals", value: 2 },
                { text: "Very poor - Rarely eat proper meals", value: 1 }
            ],
            category: "nutrition"
        },
        {
            id: 5,
            question: "What's your biggest performance challenge right now?",
            options: [
                { text: "Managing stress and anxiety", value: "mental-health" },
                { text: "Finding time and motivation to exercise", value: "fitness" },
                { text: "Eating healthy on a budget", value: "nutrition" },
                { text: "Managing money and life skills", value: "life-skills" },
                { text: "Balancing everything together", value: "general" }
            ],
            category: "priority"
        }
    ];

    let currentQuestionIndex = 0;
    let assessmentAnswers = {};
    let activeFilters = {
        categories: ['fitness', 'nutrition', 'mental-health', 'life-skills'],
        locations: ['sydney', 'online'],
        budget: ['free', 'budget']
    };

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
        // Check authentication
        const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
        if (!isLoggedIn) {
            window.location.href = 'login.html?redirect=recommendations';
            return;
        }

        // Update navigation
        document.getElementById('loginLink').style.display = 'none';
        document.getElementById('signupLink').style.display = 'none';
        document.getElementById('logoutLink').style.display = 'inline';
        document.getElementById('profileLink').style.display = 'inline';
        document.getElementById('dashboardLink').style.display = 'inline';
        document.getElementById('communityLink').style.display = 'inline';
        document.getElementById('categoryDropdown').style.display = 'block';

        // Handle logout
        document.getElementById('logoutLink').addEventListener('click', function(e) {
            e.preventDefault();
            localStorage.removeItem('userLoggedIn');
            localStorage.removeItem('authToken');
            window.location.href = 'index.html';
        });

        // Load initial content
        loadperformanceScores();
        loadRecommendations();
        
        // Track page visit
        if (window.vivifyTracker) {
            window.vivifyTracker.trackActivity('recommendations_visit', 'general', 'Recommendations page visited', 5);
        }
    });

    function loadperformanceScores() {
        const performanceData = JSON.parse(localStorage.getItem('performanceData') || '{}');
        const scores = performanceData.scores || {};
        
        document.getElementById('physicalScore').textContent = Math.round(scores.physical || 0);
        document.getElementById('mentalScore').textContent = Math.round(scores.mental || 0);
        document.getElementById('nutritionScore').textContent = Math.round(scores.nutrition || 0);
        document.getElementById('skillsScore').textContent = Math.round(scores.lifeSkills || 0);
    }

    function loadRecommendations() {
        loadPriorityRecommendations();
        loadCategoryRecommendations('fitness', 'fitnessRecommendations');
        loadCategoryRecommendations('mentalHealth', 'mentalHealthRecommendations');
        loadCategoryRecommendations('nutrition', 'nutritionRecommendations');
        loadCategoryRecommendations('lifeSkills', 'lifeSkillsRecommendations');
    }

    function loadPriorityRecommendations() {
        const container = document.getElementById('priorityRecommendations');
        const filteredRecommendations = filterRecommendations(recommendationsData.priority);
        
        if (filteredRecommendations.length === 0) {
            container.innerHTML = '<div class="empty-state"><i class="fas fa-search"></i><h3>No recommendations match your filters</h3><p>Try adjusting your filter settings</p></div>';
            return;
        }
        
        container.innerHTML = filteredRecommendations.map(createRecommendationCard).join('');
    }

    function loadCategoryRecommendations(category, containerId) {
        const container = document.getElementById(containerId);
        const recommendations = recommendationsData[category] || [];
        const filteredRecommendations = filterRecommendations(recommendations);
        
        if (filteredRecommendations.length === 0) {
            container.innerHTML = '<div class="empty-state"><i class="fas fa-search"></i><h3>No recommendations match your filters</h3><p>Try adjusting your filter settings</p></div>';
            return;
        }
        
        container.innerHTML = filteredRecommendations.map(createRecommendationCard).join('');
    }

    function filterRecommendations(recommendations) {
        return recommendations.filter(rec => {
            // Category filter
            const categoryMatch = activeFilters.categories.includes(rec.category);
            
            // Location filter
            const locationMatch = activeFilters.locations.some(loc => 
                rec.location.toLowerCase().includes(loc) || loc === 'online' && rec.location === 'Online'
            );
            
            // Budget filter
            let budgetMatch = false;
            if (activeFilters.budget.includes('free') && (rec.cost === 'Free' || rec.cost.includes('Free'))) {
                budgetMatch = true;
            }
            if (activeFilters.budget.includes('budget') && (rec.cost.includes('$') && !rec.cost.includes('Free'))) {
                budgetMatch = true;
            }
            if (activeFilters.budget.includes('premium') && rec.cost.includes('$') && parseInt(rec.cost.replace(/[^0-9]/g, '')) > 50) {
                budgetMatch = true;
            }
            
            return categoryMatch && locationMatch && budgetMatch;
        });
    }

    function createRecommendationCard(rec) {
        const priorityClass = `priority-${rec.priority}`;
        const stars = '★'.repeat(Math.floor(rec.rating)) + '☆'.repeat(5 - Math.floor(rec.rating));
        
        return `
            <div class="recommendation-card">
                ${rec.priority === 'high' ? '<div class="priority-badge priority-high">High Priority</div>' : ''}
                ${rec.priority === 'medium' ? '<div class="priority-badge priority-medium">Recommended</div>' : ''}
                
                <div class="card-header">
                    <h3 class="card-title">${rec.title}</h3>
                    <div class="card-meta">
                        <span class="card-badge">${rec.type}</span>
                        <div class="card-rating">
                            <span>${rec.rating}</span>
                            <span style="color: #f39c12;">${stars.substring(0, 5)}</span>
                        </div>
                    </div>
                </div>
                
                <div class="card-content">
                    <p class="card-description">${rec.description}</p>
                    
                    <div class="card-details">
                        <div class="detail-item">
                            <i class="fas fa-map-marker-alt detail-icon"></i>
                            <span>${rec.location}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-dollar-sign detail-icon"></i>
                            <span>${rec.cost}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-clock detail-icon"></i>
                            <span>${rec.duration}</span>
                        </div>
                    </div>
                    
                    <div class="card-actions">
                        <button class="action-btn btn-primary" onclick="exploreRecommendation(${rec.id})">
                            <i class="fas fa-external-link-alt"></i> Explore
                        </button>
                        <button class="action-btn btn-secondary" onclick="saveRecommendation(${rec.id})">
                            <i class="fas fa-bookmark"></i> Save
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    function toggleFilter(element, filterValue) {
        const checkbox = element.querySelector('.filter-checkbox');
        const isChecked = checkbox.classList.contains('checked');
        
        if (isChecked) {
            checkbox.classList.remove('checked');
            removeFromFilter(filterValue);
        } else {
            checkbox.classList.add('checked');
            addToFilter(filterValue);
        }
        
        // Reload recommendations with new filters
        loadRecommendations();
    }

    function addToFilter(filterValue) {
        const categories = ['fitness', 'nutrition', 'mental-health', 'life-skills'];
        const locations = ['sydney', 'melbourne', 'brisbane', 'online'];
        const budget = ['free', 'budget', 'premium'];
        
        if (categories.includes(filterValue)) {
            if (!activeFilters.categories.includes(filterValue)) {
                activeFilters.categories.push(filterValue);
            }
        } else if (locations.includes(filterValue)) {
            if (!activeFilters.locations.includes(filterValue)) {
                activeFilters.locations.push(filterValue);
            }
        } else if (budget.includes(filterValue)) {
            if (!activeFilters.budget.includes(filterValue)) {
                activeFilters.budget.push(filterValue);
            }
        }
    }

    function removeFromFilter(filterValue) {
        const categories = ['fitness', 'nutrition', 'mental-health', 'life-skills'];
        const locations = ['sydney', 'melbourne', 'brisbane', 'online'];
        const budget = ['free', 'budget', 'premium'];
        
        if (categories.includes(filterValue)) {
            activeFilters.categories = activeFilters.categories.filter(cat => cat !== filterValue);
        } else if (locations.includes(filterValue)) {
            activeFilters.locations = activeFilters.locations.filter(loc => loc !== filterValue);
        } else if (budget.includes(filterValue)) {
            activeFilters.budget = activeFilters.budget.filter(bud => bud !== filterValue);
        }
    }

    function startAssessment() {
        currentQuestionIndex = 0;
        assessmentAnswers = {};
        document.getElementById('assessmentModal').style.display = 'block';
        loadQuestion();
        
        if (window.vivifyTracker) {
            window.vivifyTracker.trackActivity('assessment_start', 'general', 'Started performance assessment', 10);
        }
    }

    function closeAssessment() {
        document.getElementById('assessmentModal').style.display = 'none';
    }

    function loadQuestion() {
        const question = assessmentQuestions[currentQuestionIndex];
        const isLastQuestion = currentQuestionIndex === assessmentQuestions.length - 1;
        
        document.getElementById('assessmentContent').innerHTML = `
            <div class="question-item">
                <div class="question-text">
                    Question ${currentQuestionIndex + 1} of ${assessmentQuestions.length}
                </div>
                <h3 style="color: #f39c12; margin-bottom: 1.5rem;">${question.question}</h3>
                <div class="question-options">
                    ${question.options.map((option, index) => `
                        <button class="option-btn" onclick="selectOption(${index}, '${option.value}')">
                            ${option.text}
                        </button>
                    `).join('')}
                </div>
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: space-between;">
                    ${currentQuestionIndex > 0 ? 
                        '<button class="action-btn btn-secondary" onclick="previousQuestion()">Previous</button>' : 
                        '<div></div>'
                    }
                    <button class="action-btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                        ${isLastQuestion ? 'Complete Assessment' : 'Next Question'}
                    </button>
                </div>
            </div>
        `;
    }

    function selectOption(optionIndex, value) {
        const question = assessmentQuestions[currentQuestionIndex];
        assessmentAnswers[question.id] = {
            questionId: question.id,
            optionIndex: optionIndex,
            value: value,
            category: question.category
        };
        
        // Highlight selected option
        document.querySelectorAll('.option-btn').forEach((btn, index) => {
            if (index === optionIndex) {
                btn.classList.add('selected');
            } else {
                btn.classList.remove('selected');
            }
        });
        
        // Show next button
        document.getElementById('nextBtn').style.display = 'block';
    }

    function nextQuestion() {
        if (currentQuestionIndex === assessmentQuestions.length - 1) {
            completeAssessment();
        } else {
            currentQuestionIndex++;
            loadQuestion();
        }
    }

    function previousQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            loadQuestion();
            
            // Restore previous answer if exists
            const question = assessmentQuestions[currentQuestionIndex];
            const previousAnswer = assessmentAnswers[question.id];
            if (previousAnswer) {
                selectOption(previousAnswer.optionIndex, previousAnswer.value);
            }
        }
    }

    function completeAssessment() {
        // Process assessment results
        const results = processAssessmentResults();
        
        // Save results to local storage
        localStorage.setItem('assessmentResults', JSON.stringify(results));
        
        // Update recommendations based on assessment
        updateRecommendationsFromAssessment(results);
        
        // Close modal and show success message
        closeAssessment();
        alert('Assessment complete! Your recommendations have been updated based on your responses. 🎉');
        
        // Track completion
        if (window.vivifyTracker) {
            window.vivifyTracker.trackActivity('assessment_complete', 'general', 'Completed performance assessment', 20);
        }
    }

    function processAssessmentResults() {
        const results = {
            stress_level: 0,
            fitness_level: 0,
            financial_confidence: 0,
            nutrition_quality: 0,
            priority_area: 'general',
            recommendations: []
        };
        
        // Process answers
        Object.values(assessmentAnswers).forEach(answer => {
            switch(answer.category) {
                case 'mental-health':
                    results.stress_level = answer.value;
                    break;
                case 'fitness':
                    results.fitness_level = answer.value;
                    break;
                case 'life-skills':
                    results.financial_confidence = answer.value;
                    break;
                case 'nutrition':
                    results.nutrition_quality = answer.value;
                    break;
                case 'priority':
                    results.priority_area = answer.value;
                    break;
            }
        });
        
        return results;
    }

    function updateRecommendationsFromAssessment(results) {
        // Update filters based on assessment results
        if (results.priority_area && results.priority_area !== 'general') {
            // Focus on priority area
            activeFilters.categories = [results.priority_area];
            
            // Update filter UI
            document.querySelectorAll('.filter-option').forEach(option => {
                const checkbox = option.querySelector('.filter-checkbox');
                const text = option.querySelector('.filter-text').textContent.toLowerCase();
                
                if (text.includes(results.priority_area.replace('-', ' '))) {
                    checkbox.classList.add('checked');
                } else if (['fitness', 'nutrition', 'mental', 'life'].some(cat => text.includes(cat))) {
                    checkbox.classList.remove('checked');
                }
            });
        }
        
        // Reload recommendations
        loadRecommendations();
    }

    function exploreRecommendation(recId) {
        // Find the recommendation
        const allRecs = [
            ...recommendationsData.priority,
            ...recommendationsData.fitness,
            ...recommendationsData.mentalHealth,
            ...recommendationsData.nutrition,
            ...recommendationsData.lifeSkills
        ];
        
        const recommendation = allRecs.find(rec => rec.id === recId);
        
        if (recommendation) {
            // Track exploration
            if (window.vivifyTracker) {
                window.vivifyTracker.trackActivity('recommendation_explore', recommendation.category, `Explored: ${recommendation.title}`, 8);
            }
            
            // Redirect based on category
            switch(recommendation.category) {
                case 'fitness':
                    window.location.href = 'fitness.html';
                    break;
                case 'mental-health':
                    window.location.href = 'focus-resilience.html';
                    break;
                case 'nutrition':
                    window.location.href = 'nutrition.html';
                    break;
                case 'life-skills':
                    window.location.href = 'life-mastery.html';
                    break;
                default:
                    // For external resources, show more info
                    alert(`${recommendation.title}\n\n${recommendation.description}\n\nLocation: ${recommendation.location}\nCost: ${recommendation.cost}`);
            }
        }
    }

    function saveRecommendation(recId) {
        // Get saved recommendations from local storage
        const savedRecs = JSON.parse(localStorage.getItem('savedRecommendations') || '[]');
        
        // Add if not already saved
        if (!savedRecs.includes(recId)) {
            savedRecs.push(recId);
            localStorage.setItem('savedRecommendations', JSON.stringify(savedRecs));
            alert('Recommendation saved! You can view your saved recommendations in your profile.');
            
            if (window.vivifyTracker) {
                window.vivifyTracker.trackActivity('recommendation_save', 'general', 'Saved recommendation', 5);
            }
        } else {
            alert('This recommendation is already saved.');
        }
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
        const modal = document.getElementById('assessmentModal');
        if (event.target === modal) {
            closeAssessment();
        }
    }

    // Load user location-specific recommendations
    function loadLocationSpecificRecommendations() {
        const userProfile = JSON.parse(localStorage.getItem('userProfile') || '{}');
        
        // If user has set their location, update filters accordingly
        if (userProfile.city) {
            const city = userProfile.city.toLowerCase();
            if (['sydney', 'melbourne', 'brisbane', 'perth', 'adelaide'].includes(city)) {
                // Update location filters to prioritize user's city
                activeFilters.locations = [city, 'online'];
                
                // Update UI
                document.querySelectorAll('.filter-option').forEach(option => {
                    const text = option.querySelector('.filter-text').textContent.toLowerCase();
                    const checkbox = option.querySelector('.filter-checkbox');
                    
                    if (text === city || text === 'online') {
                        checkbox.classList.add('checked');
                    } else if (['sydney', 'melbourne', 'brisbane'].includes(text)) {
                        checkbox.classList.remove('checked');
                    }
                });
                
                loadRecommendations();
            }
        }
    }

    // Load location-specific recommendations after page loads
    setTimeout(loadLocationSpecificRecommendations, 1000);

    // Add some Australian-specific recommendation enhancements
    function addAustralianContext() {
        // Add Australian university and service context
        const australianServices = [
            "Check if your university offers this service for free",
            "Many Australian universities have partnerships for student discounts",
            "Look for student concession rates with your student ID",
            "Some services offer bulk billing for students"
        ];
        
        // Randomly add helpful Australian tips
        if (Math.random() < 0.5) {
            setTimeout(() => {
                const cards = document.querySelectorAll('.recommendation-card');
                cards.forEach(card => {
                    if (Math.random() < 0.3) { // 30% chance per card
                        const tip = australianServices[Math.floor(Math.random() * australianServices.length)];
                        const tipElement = document.createElement('div');
                        tipElement.style.cssText = `
                            background: rgba(52, 152, 219, 0.1);
                            border: 1px solid #3498db;
                            border-radius: 6px;
                            padding: 0.75rem;
                            margin-top: 1rem;
                            font-size: 0.85rem;
                            color: #3498db;
                        `;
                        tipElement.innerHTML = `<i class="fas fa-lightbulb"></i> Tip: ${tip}`;
                        
                        const cardContent = card.querySelector('.card-content');
                        if (cardContent) {
                            cardContent.appendChild(tipElement);
                        }
                    }
                });
            }, 2000);
        }
    }

    // Add Australian context after content loads
    setTimeout(addAustralianContext, 3000);
</script>
<script src="js/flexible-mobile-nav.js"></script> </body>
</html>