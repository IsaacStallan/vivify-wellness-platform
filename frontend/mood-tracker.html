<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Tracker - Vivify</title>
    
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Add Font Awesome for icons -->
    
    <!-- Add Chart.js for visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Footer styles to ensure it stays at bottom */
        footer {
            background-color: #000;
            color: white;
            text-align: center;
            padding: 2rem 0;
            width: 100%;
            margin-top: auto;
            border-top: 1px solid #333;
        }

        footer .footer-links {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 1rem 0 0 0;
            padding: 0;
        }

        footer .footer-links a {
            color: #a0a0a0;
            text-decoration: none;
            transition: color 0.3s;
        }

        footer .footer-links a:hover {
            color: #f39c12;
        }
        
        /* Mood Tracker specific styles */
        .mood-hero {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), 
                        url('https://images.unsplash.com/photo-1581467655410-0c2bf55d9d6c?auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 6rem 2rem;
            text-align: center;
        }

        .mood-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .mood-hero p {
            font-size: 1.25rem;
            max-width: 800px;
            margin: 0 auto 2rem;
        }
        
        .section-title {
            color: #f39c12;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #333;
        }

        .content-container {
            max-width: 1200px;
            margin: 3rem auto;
            padding: 0 2rem;
        }

        .intro-text {
            text-align: center;
            margin-bottom: 3rem;
            line-height: 1.6;
        }

        .benefits-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 4rem;
        }

        .benefit-card {
            background-color: #222;
            border-radius: 10px;
            padding: 1.5rem;
            width: 300px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .benefit-card:hover {
            transform: translateY(-5px);
        }

        .benefit-icon {
            color: #f39c12;
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .benefit-card h3 {
            color: #f39c12;
            margin-bottom: 1rem;
        }

        .benefit-card p {
            color: #ddd;
        }

        .tracker-section {
            background-color: #222;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 4rem;
        }

        .tracker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .tracker-title {
            color: #f39c12;
            margin: 0;
            font-size: 1.8rem;
        }

        .date-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .date-selector button {
            background-color: #333;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: background-color 0.3s;
        }

        .date-selector button:hover {
            background-color: #444;
        }

        .date-display {
            font-size: 1.2rem;
            font-weight: 500;
            color: white;
            background-color: #333;
            padding: 0.5rem 1rem;
            border-radius: 5px;
        }

        .mood-input-container {
            margin-top: 2rem;
        }

        .mood-input-label {
            color: white;
            margin-bottom: 1rem;
            display: block;
            font-size: 1.2rem;
        }

        .mood-options {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .mood-option {
            background-color: #333;
            border-radius: 10px;
            padding: 1.5rem;
            width: 100px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s;
        }

        .mood-option:hover {
            transform: translateY(-5px);
            background-color: #444;
        }

        .mood-option.selected {
            background-color: rgba(243, 156, 18, 0.3);
            border: 2px solid #f39c12;
        }

        .mood-emoji {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .mood-name {
            color: white;
            font-weight: 500;
        }

        .factors-container {
            margin-top: 2rem;
        }

        .factors-label {
            color: white;
            margin-bottom: 1rem;
            display: block;
            font-size: 1.2rem;
        }

        .factors-options {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .factor-option {
            background-color: #333;
            border-radius: 5px;
            padding: 0.7rem 1.2rem;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .factor-option:hover {
            background-color: #444;
        }

        .factor-option.selected {
            background-color: rgba(243, 156, 18, 0.3);
            border: 1px solid #f39c12;
        }

        .factor-option i {
            color: #f39c12;
        }

        .notes-container {
            margin-top: 2rem;
        }

        .notes-label {
            color: white;
            margin-bottom: 1rem;
            display: block;
            font-size: 1.2rem;
        }

        textarea.notes-input {
            width: 100%;
            height: 100px;
            padding: 1rem;
            background-color: #333;
            border: 1px solid #444;
            border-radius: 5px;
            color: white;
            font-family: 'Roboto', sans-serif;
            resize: vertical;
        }

        textarea.notes-input:focus {
            outline: none;
            border-color: #f39c12;
        }

        .save-button {
            display: block;
            background-color: #f39c12;
            color: black;
            border: none;
            border-radius: 5px;
            padding: 1rem 2rem;
            margin: 2rem auto 0;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }

        .save-button:hover {
            background-color: #e67e22;
            transform: scale(1.05);
        }

        .analytics-section {
            background-color: #222;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 4rem;
        }

        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .analytics-title {
            color: #f39c12;
            margin: 0;
            font-size: 1.8rem;
        }

        .time-range-selector {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .time-option {
            background-color: #333;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .time-option:hover, .time-option.active {
            background-color: #f39c12;
            color: black;
        }

        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .chart-card {
            background-color: #333;
            border-radius: 10px;
            padding: 1.5rem;
        }

        .chart-title {
            color: #f39c12;
            margin-top: 0;
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.3rem;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .insights-container {
            margin-top: 2rem;
        }

        .insight-card {
            background-color: #333;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: flex-start;
            gap: 1.5rem;
        }

        .insight-icon {
            color: #f39c12;
            font-size: 2rem;
            margin-top: 0.5rem;
        }

        .insight-content h3 {
            color: #f39c12;
            margin-top: 0;
            margin-bottom: 0.5rem;
        }

        .insight-content p {
            color: #ddd;
            margin: 0;
        }

        .tips-section {
            background-color: #222;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 4rem;
        }

        .tips-section h2 {
            color: #f39c12;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .tips-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .tip-card {
            background-color: #333;
            border-radius: 10px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }

        .tip-number {
            background-color: #f39c12;
            color: black;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .tip-card h3 {
            color: #f39c12;
            margin-bottom: 1rem;
        }

        .tip-card p {
            color: #ddd;
            flex-grow: 1;
        }

        .cta-section {
            text-align: center;
            margin: 3rem 0;
        }

        .cta-buttons {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            flex-wrap: wrap;
        }

        .cta-button {
            display: inline-block;
            padding: 1rem 2rem;
            background-color: #f39c12;
            color: black;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 700;
            font-size: 1.1rem;
            transition: background-color 0.3s, transform 0.3s;
        }

        .cta-button:hover {
            background-color: #e67e22;
            transform: scale(1.05);
        }

        .cta-button.secondary {
            background-color: transparent;
            color: white;
            border: 2px solid #f39c12;
        }

        .cta-button.secondary:hover {
            background-color: rgba(243, 156, 18, 0.1);
        }

        @media (max-width: 768px) {
            .mood-hero h1 {
                font-size: 2.5rem;
            }
            
            .tracker-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .mood-options {
                justify-content: center;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .insight-card {
                flex-direction: column;
            }
            
            .insight-icon {
                margin-bottom: 1rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>

<!-- PWA Manifest -->
<link rel="manifest" href="/manifest.json">

<!-- iOS PWA Support -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="performance Hub">
<link rel="apple-touch-icon" href="/icons/icon-192x192.png">
<link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180x180.png">

<!-- Microsoft Tiles -->
<meta name="msapplication-TileImage" content="/icons/icon-144x144.png">
<meta name="msapplication-TileColor" content="#f39c12">

<!-- Theme Color -->
<meta name="theme-color" content="#f39c12">

<!-- Viewport for PWA -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

<!-- Preload PWA installer script -->
<link rel="preload" href="/pwa-install.js" as="script">
<!-- CSS Loading Order Fix -->

<link rel="stylesheet" href="styles.css">

<!-- FOUC Prevention -->
<style>
    html { visibility: hidden; opacity: 0; }
    html.loaded { visibility: visible; opacity: 1; transition: opacity 0.3s ease; }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.documentElement.classList.add('loaded');
    });
    window.addEventListener('load', function() {
        document.documentElement.classList.add('loaded');
    });
</script>
<script src="js/vivify-stats.js"></script>
<script src="js/leaderboard-system.js"></script>
</head>
<body>
    <div class="wrapper">
        <header>
            <nav>
                <div class="left-nav">
                    <div class="logo">
                        <a href="index.html" aria-label="Home Page"><h1>Vivify</h1></a>
                    </div>
                    <ul>
                        <li><a href="about.html" aria-label="About Us Page">About</a></li>
                        <li class="dropdown" id="categoryDropdown">
                            <a href="#" class="dropbtn" aria-label="Categories Dropdown">Training</a>
                            <div class="dropdown-content">
                                <a href="fitness.html" aria-label="Fitness Page">Fitness</a>
                                <a href="nutrition.html" aria-label="Nutrition Page">Nutrition</a>
                                <a href="focus-resilience.html" class="active" aria-label="Focus & Resilience Page">Focus & Resilience</a>
                                <a href="life-mastery.html" aria-label="Life Lessons Page">Life Mastery</a>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="right-nav">
                    <ul>
                        <li><a href="dashboard.html" id="dashboardLink" aria-label="Dashboard">Performance Hub</a></li>
                        <li><a href="profile.html" id="profileLink" aria-label="Profile Page">Profile</a></li>
                        <li><a href="#" id="logoutLink" aria-label="Logout">Logout</a></li>
                        <li><a href="login.html" id="loginLink" style="display: none;" aria-label="Login Page">Login</a></li>
                        <li><a href="signup.html" id="signupLink" style="display: none;" aria-label="Sign Up Page">Sign Up</a></li>
                    </ul>
                </div>
            </nav>
        </header>

        <!-- Hero Section -->
        <section class="mood-hero">
            <h1>Track Your Mood Journey</h1>
            <p>Understand your emotional patterns, identify triggers, and discover strategies to improve your mental wellbeing through consistent mood tracking.</p>
            <a href="#mood-tracker" class="cta-button">Start Tracking Now</a>
        </section>

        <div class="content-container">
            <!-- Introduction -->
            <div class="intro-text">
                <p>
                    Your emotions are valuable data that can help you understand yourself better. By consistently tracking your moods, you'll begin to recognize patterns, identify triggers, and develop more effective coping strategies. This tool is designed to help you build emotional awareness—a key component of Focus & Resilience—while providing actionable insights to enhance your student experience.
                </p>
            </div>

            <!-- Benefits Section -->
            <h2 class="section-title">Benefits of Mood Tracking</h2>
            <div class="benefits-container">
                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3>Pattern Recognition</h3>
                    <p>Identify recurring emotional patterns related to academic schedules, sleep, social interactions, and other lifestyle factors.</p>
                </div>

                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <h3>Trigger Awareness</h3>
                    <p>Discover specific situations, environments, or behaviors that consistently impact your mood positively or negatively.</p>
                </div>

                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="fas fa-handshake"></i>
                    </div>
                    <h3>Better Communication</h3>
                    <p>Develop a richer emotional vocabulary and increased awareness that helps you communicate more effectively with others.</p>
                </div>

                <div class="benefit-card">
                    <div class="benefit-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3>Early Intervention</h3>
                    <p>Recognize signs of declining Focus & Resilience early, allowing you to implement coping strategies before problems escalate.</p>
                </div>
            </div>

            <!-- Mood Tracker Input Section -->
            <div id="mood-tracker" class="tracker-section">
                <div class="tracker-header">
                    <h2 class="tracker-title">Today's Mood Check-In</h2>
                    <div class="date-selector">
                        <button id="prev-day-btn"><i class="fas fa-chevron-left"></i> Previous</button>
                        <div class="date-display" id="selected-date">Today, April 17</div>
                        <button id="next-day-btn" disabled>Next <i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                
                <div class="mood-input-container">
                    <label class="mood-input-label">How are you feeling today?</label>
                    <div class="mood-options">
                        <div class="mood-option" data-mood="great">
                            <div class="mood-emoji">😄</div>
                            <div class="mood-name">Great</div>
                        </div>
                        <div class="mood-option" data-mood="good">
                            <div class="mood-emoji">🙂</div>
                            <div class="mood-name">Good</div>
                        </div>
                        <div class="mood-option" data-mood="okay">
                            <div class="mood-emoji">😐</div>
                            <div class="mood-name">Okay</div>
                        </div>
                        <div class="mood-option" data-mood="down">
                            <div class="mood-emoji">😔</div>
                            <div class="mood-name">Down</div>
                        </div>
                        <div class="mood-option" data-mood="terrible">
                            <div class="mood-emoji">😫</div>
                            <div class="mood-name">Terrible</div>
                        </div>
                    </div>
                </div>
                
                <div class="factors-container">
                    <label class="factors-label">What factors are influencing your mood today? (Select all that apply)</label>
                    <div class="factors-options">
                        <div class="factor-option" data-factor="sleep">
                            <i class="fas fa-bed"></i> Sleep
                        </div>
                        <div class="factor-option" data-factor="exercise">
                            <i class="fas fa-running"></i> Exercise
                        </div>
                        <div class="factor-option" data-factor="nutrition">
                            <i class="fas fa-apple-alt"></i> Nutrition
                        </div>
                        <div class="factor-option" data-factor="social">
                            <i class="fas fa-users"></i> Social Interaction
                        </div>
                        <div class="factor-option" data-factor="academic">
                            <i class="fas fa-book"></i> Academic Pressure
                        </div>
                        <div class="factor-option" data-factor="stress">
                            <i class="fas fa-bolt"></i> Stress
                        </div>
                        <div class="factor-option" data-factor="health">
                            <i class="fas fa-heartbeat"></i> Health
                        </div>
                        <div class="factor-option" data-factor="weather">
                            <i class="fas fa-cloud-sun"></i> Weather
                        </div>
                        <div class="factor-option" data-factor="leisure">
                            <i class="fas fa-gamepad"></i> Leisure Time
                        </div>
                    </div>
                </div>
                
                <div class="notes-container">
                    <label class="notes-label">Additional notes (optional)</label>
                    <textarea class="notes-input" id="mood-notes" placeholder="Add any additional thoughts, specific events, or reflections about your day..."></textarea>
                </div>
                
                <button id="save-mood-btn" class="save-button">Save Today's Mood</button>
            </div>

            <!-- Mood Analytics Section -->
            <div class="analytics-section">
                <div class="analytics-header">
                    <h2 class="analytics-title">Your Mood Patterns & Insights</h2>
                    <div class="time-range-selector">
                        <button class="time-option active" data-range="week">Week</button>
                        <button class="time-option" data-range="month">Month</button>
                        <button class="time-option" data-range="3months">3 Months</button>
                    </div>
                </div>
                
                <div class="charts-container">
                    <div class="chart-card">
                        <h3 class="chart-title">Mood Trends Over Time</h3>
                        <div class="chart-container">
                            <canvas id="mood-trend-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3 class="chart-title">Mood-Influencing Factors</h3>
                        <div class="chart-container">
                            <canvas id="mood-factors-chart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="insights-container">
                    <h3 style="color: #f39c12; margin-bottom: 1.5rem;">Personalized Insights</h3>
                    
                    <div class="insight-card">
                        <div class="insight-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div class="insight-content">
                            <h3>Exercise Seems to Boost Your Mood</h3>
                            <p>On days when you've exercised, your mood has been 40% more likely to be "Good" or "Great" compared to days without exercise. Consider prioritizing regular physical activity, even if it's just a short walk between classes.</p>
                        </div>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-icon">
                            <i class="fas fa-bed"></i>
                        </div>
                        <div class="insight-content">
                            <h3>Sleep Quality Affects Your Daily Outlook</h3>
                            <p>Your data shows a strong correlation between sleep issues and lower mood ratings the following day. When you rate "Sleep" as a negative factor, your mood is typically lower. Consider exploring the Sleep Meditation series to improve your rest.</p>
                        </div>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="insight-content">
                            <h3>Academic Pressure Peaks on Mondays</h3>
                            <p>You've consistently reported higher stress and lower mood on Mondays, often citing "Academic Pressure" as a factor. Consider implementing a Sunday evening planning session to feel more prepared for the week ahead.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mood Management Tips Section -->
            <div class="tips-section">
                <h2>Tips for Emotional Wellbeing</h2>
                <div class="tips-container">
                    <div class="tip-card">
                        <div class="tip-number">1</div>
                        <h3>Micro-Mindfulness</h3>
                        <p>Integrate 2-minute mindfulness breaks between study sessions. Focus on your breath, notice physical sensations, and gently return attention when your mind wanders.</p>
                    </div>
                    
                    <div class="tip-card">
                        <div class="tip-number">2</div>
                        <h3>Mood-Boosting Movement</h3>
                        <p>When feeling low, try 5-10 minutes of movement—stretching, dancing, or a quick walk outside. Physical activity can quickly shift your neurochemistry and improve mood.</p>
                    </div>
                    
                    <div class="tip-card">
                        <div class="tip-number">3</div>
                        <h3>Social Connection</h3>
                        <p>Schedule regular meaningful social interactions, even during busy periods. Brief, supportive connections can significantly impact emotional wellbeing.</p>
                    </div>
                    
                    <div class="tip-card">
                        <div class="tip-number">4</div>
                        <h3>Emotional Labeling</h3>
                        <p>Practice naming your emotions with specificity (e.g., "disappointed" instead of "sad"). This helps process feelings and reduces their intensity.</p>
                    </div>
                </div>
            </div>

            <!-- Call to Action -->
            <div class="cta-section">
                <h2 class="section-title">Enhance Your Emotional Wellbeing</h2>
                <div class="cta-buttons">
                    <a href="guided-meditations.html" class="cta-button">Explore Guided Meditations</a>
                    <a href="stress-management.html" class="cta-button secondary">View Stress Management Tools</a>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p>&copy; 2025 Vivify. All rights reserved.</p>
            <ul class="footer-links">
                <li><a href="privacy.html" aria-label="Privacy Policy">Privacy Policy</a></li>
                <li><a href="terms.html" aria-label="Terms of Service">Terms of Service</a></li>
                <li><a href="contact.html" aria-label="Contact Us">Contact Us</a></li>
            </ul>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is logged in
            const isLoggedIn = localStorage.getItem('userLoggedIn') === 'true';
            
            // Update UI based on login status
            document.getElementById('loginLink').style.display = isLoggedIn ? 'none' : 'inline';
            document.getElementById('signupLink').style.display = isLoggedIn ? 'none' : 'inline';
            document.getElementById('logoutLink').style.display = isLoggedIn ? 'inline' : 'none';
            document.getElementById('profileLink').style.display = isLoggedIn ? 'inline' : 'none';
            document.getElementById('dashboardLink').style.display = isLoggedIn ? 'inline' : 'none';
            
            // Handle logout
            document.getElementById('logoutLink').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('userLoggedIn');
                localStorage.removeItem('authToken');
                window.location.href = 'index.html';
            });
            
            // Initialize the mood tracker functionality
            initMoodTracker();
            
            // Initialize the mood analytics charts
            initMoodCharts();
        });
        
        // Current date handling
        let currentDate = new Date();
        const dateDisplay = document.getElementById('selected-date');
        const prevDayBtn = document.getElementById('prev-day-btn');
        const nextDayBtn = document.getElementById('next-day-btn');
        
        // Format and display the current date
        function updateDateDisplay() {
            const options = { weekday: 'long', month: 'long', day: 'numeric' };
            dateDisplay.textContent = currentDate.toLocaleDateString('en-US', options);
            
            // Enable/disable navigation buttons
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const selectedDate = new Date(currentDate);
            selectedDate.setHours(0, 0, 0, 0);
            
            // Disable next button if current date is today
            nextDayBtn.disabled = selectedDate.getTime() >= today.getTime();
            
            // Disable prev button if we're looking at data from more than 3 months ago
            const threeMonthsAgo = new Date();
            threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);
            prevDayBtn.disabled = selectedDate.getTime() <= threeMonthsAgo.getTime();
            
            // Load mood data for the selected date
            loadMoodData(currentDate);
        }
        
        // Initialize the mood tracker functionality
        function initMoodTracker() {
            // Set up date navigation
            prevDayBtn.addEventListener('click', () => {
                currentDate.setDate(currentDate.getDate() - 1);
                updateDateDisplay();
            });
            
            nextDayBtn.addEventListener('click', () => {
                currentDate.setDate(currentDate.getDate() + 1);
                updateDateDisplay();
            });
            
            // Update the date display initially
            updateDateDisplay();
            
            // Set up mood selection
            const moodOptions = document.querySelectorAll('.mood-option');
            moodOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Remove selected class from all options
                    moodOptions.forEach(opt => opt.classList.remove('selected'));
                    // Add selected class to clicked option
                    option.classList.add('selected');
                });
            });
            
            // Set up factor selection
            const factorOptions = document.querySelectorAll('.factor-option');
            factorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Toggle selected class
                    option.classList.toggle('selected');
                });
            });
            
            // Set up save button
            const saveButton = document.getElementById('save-mood-btn');
            saveButton.addEventListener('click', saveMoodData);
        }
        
        // Save mood data
        function saveMoodData() {
            // Get selected mood
            const selectedMood = document.querySelector('.mood-option.selected');
            if (!selectedMood) {
                alert('Please select a mood before saving.');
                return;
            }
            
            // Get selected factors
            const selectedFactors = document.querySelectorAll('.factor-option.selected');
            const factors = Array.from(selectedFactors).map(factor => factor.dataset.factor);
            
            // Get notes
            const notes = document.getElementById('mood-notes').value;
            
            // Create mood entry
            const moodEntry = {
                date: currentDate.toISOString(),
                mood: selectedMood.dataset.mood,
                factors: factors,
                notes: notes
            };
            
            // Save to local storage
            saveMoodEntryToStorage(moodEntry);
            
            // Show success message
            alert('Your mood has been saved successfully!');
            
            // Reset form if the selected date is today
            const today = new Date();
            if (isSameDay(currentDate, today)) {
                resetMoodForm();
            }
            
            // Refresh charts
            initMoodCharts();
        }
        
        // Save mood entry to local storage
        function saveMoodEntryToStorage(moodEntry) {
            // Get existing entries
            let moodEntries = JSON.parse(localStorage.getItem('moodEntries')) || [];
            
            // Check if an entry already exists for this date
            const dateString = moodEntry.date.split('T')[0]; // Get YYYY-MM-DD part
            const existingEntryIndex = moodEntries.findIndex(entry => {
                const entryDate = entry.date.split('T')[0];
                return entryDate === dateString;
            });
            
            // Update or add the entry
            if (existingEntryIndex !== -1) {
                moodEntries[existingEntryIndex] = moodEntry;
            } else {
                moodEntries.push(moodEntry);
            }
            
            // Sort entries by date (newest first)
            moodEntries.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Save back to local storage
            localStorage.setItem('moodEntries', JSON.stringify(moodEntries));
        }
        
        // Load mood data for a specific date
        function loadMoodData(date) {
            // Reset the form first
            resetMoodForm();
            
            // Get entries from local storage
            const moodEntries = JSON.parse(localStorage.getItem('moodEntries')) || [];
            
            // Find entry for the selected date
            const dateString = date.toISOString().split('T')[0]; // Get YYYY-MM-DD part
            const entry = moodEntries.find(entry => {
                const entryDate = entry.date.split('T')[0];
                return entryDate === dateString;
            });
            
            // If an entry exists, populate the form
            if (entry) {
                // Select the mood
                const moodOption = document.querySelector(`.mood-option[data-mood="${entry.mood}"]`);
                if (moodOption) {
                    moodOption.classList.add('selected');
                }
                
                // Select the factors
                entry.factors.forEach(factor => {
                    const factorOption = document.querySelector(`.factor-option[data-factor="${factor}"]`);
                    if (factorOption) {
                        factorOption.classList.add('selected');
                    }
                });
                
                // Set the notes
                document.getElementById('mood-notes').value = entry.notes || '';
            }
        }
        
        // Reset mood form
        function resetMoodForm() {
            // Clear mood selection
            document.querySelectorAll('.mood-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Clear factor selection
            document.querySelectorAll('.factor-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Clear notes
            document.getElementById('mood-notes').value = '';
        }
        
        // Initialize mood charts
        function initMoodCharts() {
            // Get mood entries from local storage
            const moodEntries = JSON.parse(localStorage.getItem('moodEntries')) || [];
            
            // If no entries, show placeholder data
            if (moodEntries.length === 0) {
                initPlaceholderCharts();
                return;
            }
            
            // Get selected time range
            const activeRangeBtn = document.querySelector('.time-option.active');
            const timeRange = activeRangeBtn ? activeRangeBtn.dataset.range : 'week';
            
            // Filter entries based on time range
            const filteredEntries = filterEntriesByTimeRange(moodEntries, timeRange);
            
            // Initialize the mood trend chart
            initMoodTrendChart(filteredEntries);
            
            // Initialize the mood factors chart
            initMoodFactorsChart(filteredEntries);
        }
        
        // Filter entries by time range
        function filterEntriesByTimeRange(entries, range) {
            const now = new Date();
            let startDate;
            
            switch (range) {
                case 'week':
                    startDate = new Date(now);
                    startDate.setDate(now.getDate() - 7);
                    break;
                case 'month':
                    startDate = new Date(now);
                    startDate.setMonth(now.getMonth() - 1);
                    break;
                case '3months':
                    startDate = new Date(now);
                    startDate.setMonth(now.getMonth() - 3);
                    break;
                default:
                    startDate = new Date(now);
                    startDate.setDate(now.getDate() - 7);
            }
            
            return entries.filter(entry => new Date(entry.date) >= startDate);
        }
        
        // Initialize mood trend chart
        function initMoodTrendChart(entries) {
            // Get the canvas element
            const ctx = document.getElementById('mood-trend-chart').getContext('2d');
            
            // Sort entries by date (oldest first for charting)
            const sortedEntries = [...entries].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Prepare data
            const labels = sortedEntries.map(entry => {
                const date = new Date(entry.date);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            });
            
            const moodValues = sortedEntries.map(entry => {
                // Convert mood to numeric value
                switch (entry.mood) {
                    case 'terrible': return 1;
                    case 'down': return 2;
                    case 'okay': return 3;
                    case 'good': return 4;
                    case 'great': return 5;
                    default: return 3;
                }
            });
            
            // Check if we have an existing chart and destroy it
            if (window.moodTrendChart) {
                window.moodTrendChart.destroy();
            }
            
            // Create the chart
            window.moodTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Mood Rating',
                        data: moodValues,
                        backgroundColor: 'rgba(243, 156, 18, 0.2)',
                        borderColor: '#f39c12',
                        borderWidth: 2,
                        pointBackgroundColor: '#f39c12',
                        pointBorderColor: '#fff',
                        pointRadius: 5,
                        tension: 0.2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 0.5,
                            max: 5.5,
                            ticks: {
                                stepSize: 1,
                                callback: function(value) {
                                    switch (value) {
                                        case 1: return 'Terrible';
                                        case 2: return 'Down';
                                        case 3: return 'Okay';
                                        case 4: return 'Good';
                                        case 5: return 'Great';
                                        default: return '';
                                    }
                                },
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#f39c12',
                            bodyColor: '#fff',
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    let moodText;
                                    switch (value) {
                                        case 1: moodText = 'Terrible'; break;
                                        case 2: moodText = 'Down'; break;
                                        case 3: moodText = 'Okay'; break;
                                        case 4: moodText = 'Good'; break;
                                        case 5: moodText = 'Great'; break;
                                        default: moodText = 'Unknown'; break;
                                    }
                                    return `Mood: ${moodText}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Initialize mood factors chart
        function initMoodFactorsChart(entries) {
            // Get the canvas element
            const ctx = document.getElementById('mood-factors-chart').getContext('2d');
            
            // Count factor occurrences
            const factorCounts = {};
            entries.forEach(entry => {
                entry.factors.forEach(factor => {
                    if (factorCounts[factor]) {
                        factorCounts[factor]++;
                    } else {
                        factorCounts[factor] = 1;
                    }
                });
            });
            
            // Prepare data
            const labels = Object.keys(factorCounts);
            const data = Object.values(factorCounts);
            
            // Map factor names to more readable labels
            const factorLabels = labels.map(factor => {
                switch (factor) {
                    case 'sleep': return 'Sleep';
                    case 'exercise': return 'Exercise';
                    case 'nutrition': return 'Nutrition';
                    case 'social': return 'Social';
                    case 'academic': return 'Academic';
                    case 'stress': return 'Stress';
                    case 'health': return 'Health';
                    case 'weather': return 'Weather';
                    case 'leisure': return 'Leisure';
                    default: return factor.charAt(0).toUpperCase() + factor.slice(1);
                }
            });
            
            // Check if we have an existing chart and destroy it
            if (window.moodFactorsChart) {
                window.moodFactorsChart.destroy();
            }
            
            // Create the chart
            window.moodFactorsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: factorLabels,
                    datasets: [{
                        label: 'Frequency',
                        data: data,
                        backgroundColor: '#f39c12',
                        borderColor: '#e67e22',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1,
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#f39c12',
                            bodyColor: '#fff'
                        }
                    }
                }
            });
        }
        
        // Initialize placeholder charts (for new users with no data)
        function initPlaceholderCharts() {
            // Placeholder data for mood trend chart
            const moodTrendLabels = ['Apr 10', 'Apr 11', 'Apr 12', 'Apr 13', 'Apr 14', 'Apr 15', 'Apr 16'];
            const moodTrendData = [3, 4, 3, 2, 3, 4, 5];
            
            // Placeholder data for mood factors chart
            const factorLabels = ['Sleep', 'Exercise', 'Nutrition', 'Social', 'Academic', 'Stress'];
            const factorData = [5, 4, 3, 4, 6, 7];
            
            // Initialize mood trend chart with placeholder data
            const trendCtx = document.getElementById('mood-trend-chart').getContext('2d');
            if (window.moodTrendChart) {
                window.moodTrendChart.destroy();
            }
            window.moodTrendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: moodTrendLabels,
                    datasets: [{
                        label: 'Mood Rating (Sample Data)',
                        data: moodTrendData,
                        backgroundColor: 'rgba(243, 156, 18, 0.2)',
                        borderColor: '#f39c12',
                        borderWidth: 2,
                        pointBackgroundColor: '#f39c12',
                        pointBorderColor: '#fff',
                        pointRadius: 5,
                        tension: 0.2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 0.5,
                            max: 5.5,
                            ticks: {
                                stepSize: 1,
                                callback: function(value) {
                                    switch (value) {
                                        case 1: return 'Terrible';
                                        case 2: return 'Down';
                                        case 3: return 'Okay';
                                        case 4: return 'Good';
                                        case 5: return 'Great';
                                        default: return '';
                                    }
                                },
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#f39c12',
                            bodyColor: '#fff'
                        }
                    }
                }
            });
            
            // Initialize mood factors chart with placeholder data
            const factorsCtx = document.getElementById('mood-factors-chart').getContext('2d');
            if (window.moodFactorsChart) {
                window.moodFactorsChart.destroy();
            }
            window.moodFactorsChart = new Chart(factorsCtx, {
                type: 'bar',
                data: {
                    labels: factorLabels,
                    datasets: [{
                        label: 'Frequency (Sample Data)',
                        data: factorData,
                        backgroundColor: '#f39c12',
                        borderColor: '#e67e22',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1,
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#ddd'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#f39c12',
                            bodyColor: '#fff'
                        }
                    }
                }
            });
        }
        
        // Set up time range selectors
        document.querySelectorAll('.time-option').forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                document.querySelectorAll('.time-option').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Add active class to clicked button
                button.classList.add('active');
                
                // Refresh charts with new time range
                initMoodCharts();
            });
        });
        
        // Helper function to check if two dates are the same day
        function isSameDay(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }
    </script>

<!-- PWA Scripts -->


<script>
// Additional PWA features for each page
document.addEventListener('DOMContentLoaded', function() {
    // Add PWA-specific styles
    if (window.matchMedia('(display-mode: standalone)').matches) {
        document.body.classList.add('pwa-mode');
        
        // Hide address bar on mobile when in PWA mode
        window.scrollTo(0, 1);
    }
    
    // Handle network status
    function updateOnlineStatus() {
        const statusElement = document.getElementById('network-status');
        if (statusElement) {
            if (navigator.onLine) {
                statusElement.textContent = 'Online';
                statusElement.className = 'online';
            } else {
                statusElement.textContent = 'Offline';
                statusElement.className = 'offline';
            }
        }
    }
    
    window.addEventListener('online', updateOnlineStatus);
    window.addEventListener('offline', updateOnlineStatus);
    updateOnlineStatus();
    
    // Add network status indicator if it doesn't exist
    if (!document.getElementById('network-status')) {
        const statusDiv = document.createElement('div');
        statusDiv.id = 'network-status';
        statusDiv.style.cssText = `
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            z-index: 1000;
            transition: all 0.3s ease;
        `;
        document.body.appendChild(statusDiv);
        updateOnlineStatus();
    }
});
</script>
<script src="class-management.js"></script> </body>
</html>